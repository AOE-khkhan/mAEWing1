/*! \file systemid_functions.c
 *	\brief Auxiliary System ID functions
 *
 *	\details  Auxiliary system ID functions. Doublets and multisines.
 *	\ingroup systemid_fcns
 *
 * \author University of Minnesota
 * \author Aerospace Engineering and Mechanics
 * \copyright Copyright 2011 Regents of the University of Minnesota. All rights reserved.
 *
 * $Id: systemid_functions.c 756 2012-01-04 18:51:43Z murch $
 */
#include <stdlib.h>
#include <math.h>

#include "../globaldefs.h"
#include "systemid_interface.h"


double doublet(double t0, double currentTime, double duration, double amplitude) {
	double t = currentTime; // simulink current time

	if (t < t0)
		return 0;
	else if ((t >= t0) && (t < t0 + 0.5 * duration))
		return amplitude;
	else if ((t >= t0 + 0.5 * duration) && (t < t0 + duration))
		return -amplitude;
	if (t >= t0 + duration)
		return 0;

	return 0;
}
/*****************************************************************************/
double doublet121(double t0, double currentTime, double dur1, double dur2,
		double dur3, double amplitude) {
	double t = currentTime; // simulink current time

	if (t < t0) {
		return 0;
	} else {
		if ((t >= t0) && (t <= t0 + dur1)) {
			return amplitude;
		}

		if ((t >= t0 + dur1 + dur2) && (t <= t0 + dur1 + dur2 + dur3)) {
			return -amplitude;
		}

		if ((t >= t0 + dur1 + 2 * dur2 + dur3) && (t <= t0 + 2 * dur1 + 2
				* dur2 + dur3)) {
			return amplitude;
		}

	}

	return 0;
}

double doublet3211(double t0, double currentTime, double dur1, double amplitude) {
	double t = currentTime; // simulink current time

	if (t < t0) {
		return 0;
	} else {
		if ((t >= t0) && (t <= t0 + 3*dur1)) {
			return amplitude;
		}

		if ((t >= t0 + 3*dur1) && (t <= t0 + 3*dur1 + 2*dur1)) {
			return -amplitude;
		}

		if ((t >= t0 + 3*dur1 + 2*dur1) && (t <= t0 + 3*dur1 + 2*dur1 + dur1)) {
			return amplitude;
		}
		
		if ((t >= t0 + 3*dur1 + 2*dur1 + dur1) && (t <= t0 + 3*dur1 + 2*dur1 + dur1 + dur1)) {
			return -amplitude;
		}

	}

	return 0;
}

double cos_chirp(double time, double time_start, double duration, double freq_start, double freq_stop, double amp_start, double amp_stop){
	double f;		// frequency
	double a;		// amplitude
	double excite;	// excitation command, rad
	
	if((time > time_start)&&((time - time_start)<duration)){
		
		f = freq_start + (freq_stop - freq_start)/(2.0*duration)*(time - time_start);
		a = (amp_start - amp_stop)/2.0 * cos(PI*((time - time_start)/duration)) + (amp_start + amp_stop)/2.0;
		excite = a * D2R * sin(2.0 * PI * f * (time-time_start));
		
		return excite;
	}
	else{
		return 0;
	}
}

double step_chirp(double time, double time_start, double step_time, double duration, double freq_start, double freq_stop, double amp_start, double amp_stop){
	double f;		// frequency
	double a;		// amplitude
	double excite;	// excitation command, rad
	
	if((time > time_start)&&((time - time_start)<duration)){
		
		f = freq_start + (freq_stop - freq_start)/(2.0*duration)*(time - time_start);
		
		if((time - time_start) < step_time){
			a = amp_start;
		}
		else{
			a = amp_stop;
		}
		
		excite = a * D2R * sin(2.0 * PI * f * (time-time_start));
		
		return excite;
	}
	else{
		return 0;
	}
}

void one_multi_sine(double t, double *dsurf, double amp) {
	// frequencies, phase shifts, and amplitude
	static double freq[19] = { 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
			1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0 };
	static double phase[19] = { -1.27957909013141, 0.348919604845833,
			1.55845288184890, 2.33381811735615, -2.64342812535867,
			-1.67389505727660, -1.14853051767376, -2.02216246930373,
			-2.23926930233022, -2.13146859961157, 2.12830296200715,
			1.05375292070553, -1.20359723220569, -2.76268622179216,
			0.761666786086764, -1.36337190551698, 0.702943945363515,
			-2.04688882119523, 0.191156846541546 };

	double dtmp = 0.0;
	int i;

	for (i = 0; i < 19; i++) {
		dtmp += cos(freq[i] * 2 * PI * t + phase[i]) * sqrt(1.0 / 19) * amp; //rad, multi-sine signal
	}
	// assign control surface command to pointers
	*dsurf = dtmp;

}

void two_multi_sine(double t, double *dsurf1, double *dsurf2, double amp1,
		double amp2) {
	// frequencies, phase shifts, and amplitude
	static double freq1[9] = { 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8 };
	static double phase1[9] = { -0.137821438846238, -1.08680859297711,
			2.84479381592806, -0.802006213664591, -2.53910175103649,
			-2.42015912163347, 2.83051687898700, -1.18873893747093,
			-0.282979519213328 };

	static double freq2[9] = { 0.3, 0.5, 0.7, 0.9, 1.1, 1.3, 1.5, 1.7, 1.9 };
	static double phase2[9] = { 3.09701787648288, 0.702903781602135,
			-2.79553911432363, 1.21228624745064, 1.26880068387565,
			-0.247242270325405, 0.257811486280133, 2.03325959168130,
			2.87014496403833 };

	double dtmp1 = 0.0;
	double dtmp2 = 0.0;
	int i;

	for (i = 0; i < 9; i++) {
		dtmp1 += cos(freq1[i] * 2 * PI * t + phase1[i]) * sqrt(1.0 / 9) * amp1; //rad, multi-sine signal
		dtmp2 += cos(freq2[i] * 2 * PI * t + phase2[i]) * sqrt(1.0 / 9) * amp2; //rad, multi-sine signal
	}
	// assign control surface command to pointers
	*dsurf1 = dtmp1;
	*dsurf2 = dtmp2;

}

void three_multi_sine(double t, double *de, double *da, double*dr) {
	// elevator frequencies and phase shifts
	static double freq_e[6] = { 0.2, 0.5, 0.8, 1.1, 1.4, 1.7 };
	static double phase_e[6] = { 1.58451760333862, -0.258368383798533,
			0.320626859635127, -2.79550026546313, 2.91618215748278,
			-1.55693424076394 };
	static double amp_e = 2.0; // amplitude, in degrees
	// aileron frequencies and phase shifts
	static double freq_a[6] = { 0.3, 0.6, 0.9, 1.2, 1.5, 1.8 };
	static double phase_a[6] = { 1.43549689823698, -1.24587349532040,
			-0.282364765506209, -2.87394881269454, -1.80524182936679,
			-1.79022442236836 };
	static double amp_a = 2.0; // amplitude, in degrees
	// rudder frequencies and phase shifts
	static double freq_r[6] = { 0.4, 0.7, 1.0, 1.3, 1.6, 1.9 };
	static double phase_r[6] = { 0.102843043899529, 2.93051441701122,
			2.50176467719111, 1.58251088240054, 0.158685053706918,
			1.76461734166891 };
	static double amp_r = 1.0; // amplitude, in degrees
	double detmp = 0;
	double datmp = 0;
	double drtmp = 0; // dummy variables
	int i;

	// Create multi sine inputs. There are 6 frequencies in each signal.
	for (i = 0; i < 6; i++) {
		detmp += cos(freq_e[i] * 2 * PI * t + phase_e[i]) * sqrt(1.0 / 6) * amp_e;//rad, elevator multi-sine
		datmp += cos(freq_a[i] * 2 * PI * t + phase_a[i]) * sqrt(1.0 / 6) * amp_a;//rad, aileron multi-sine
		drtmp += cos(freq_r[i] * 2 * PI * t + phase_r[i]) * sqrt(1.0 / 6) * amp_r;//rad, rudder multi-sine
	}
	// assign control surface commands to pointers
	*de = detmp;
	*da = datmp;
	*dr = drtmp;

}

// 2 Channel OMS 0.8 Hz to 18.5 Hz
double playback_OMS2_1(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS2_ch1[1799] = {0.4789,0.4868,0.5277,0.6393,0.8446,1.1183,1.3754,1.4943,1.3675,0.9573,0.3288,-0.3596,-0.9093,-1.1576,-1.0430,-0.6319,-0.0910,0.3829,0.6444,0.6560,0.4946,0.3056,0.2278,0.3248,0.5569,0.8047,0.9333,0.8619,0.6053,0.2650,-0.0240,-0.1645,-0.1470,-0.0539,-0.0134,-0.1275,-0.4111,-0.7736,-1.0565,-1.1070,-0.8529,-0.3416,0.2775,0.8166,1.1296,1.1674,0.9855,0.7011,0.4275,0.2196,0.0600,-0.1104,-0.3376,-0.6092,-0.8464,-0.9413,-0.8185,-0.4881,-0.0581,0.3050,0.4497,0.3116,-0.0532,-0.4923,-0.8274,-0.9375,-0.8133,-0.5569,-0.3268,-0.2576,-0.3925,-0.6629,-0.9215,-1.0128,-0.8440,-0.4251,0.1388,0.6940,1.0998,1.2749,1.2145,0.9764,0.6506,0.3306,0.0957,0.0035,0.0840,0.3299,0.6859,1.0464,1.2751,1.2488,0.9121,0.3172,-0.3750,-0.9448,-1.1981,-1.0509,-0.5727,0.0362,0.5282,0.7161,0.5556,0.1601,-0.2580,-0.4947,-0.4543,-0.1942,0.1099,0.2586,0.1359,-0.2284,-0.6735,-0.9915,-1.0376,-0.8070,-0.4390,-0.1438,-0.0893,-0.3097,-0.6823,-0.9876,-1.0235,-0.7147,-0.1612,0.4010,0.7083,0.5946,0.0719,-0.6721,-1.3575,-1.7345,-1.6869,-1.2708,-0.6751,-0.1290,0.1957,0.2428,0.0717,-0.1927,-0.4248,-0.5458,-0.5345,-0.4065,-0.1856,0.1121,0.4708,0.8545,1.1944,1.3994,1.3924,1.1528,0.7400,0.2793,-0.0892,-0.2741,-0.2764,-0.1860,-0.1323,-0.2103,-0.4239,-0.6769,-0.8199,-0.7314,-0.3895,0.1033,0.5594,0.7901,0.6953,0.3103,-0.2107,-0.6682,-0.9099,-0.8943,-0.6961,-0.4528,-0.2838,-0.2269,-0.2241,-0.1654,0.0385,0.3928,0.8017,1.1082,1.1685,0.9235,0.4292,-0.1683,-0.6987,-1.0408,-1.1644,-1.1248,-1.0176,-0.9214,-0.8625,-0.8172,-0.7466,-0.6372,-0.5197,-0.4528,-0.4803,-0.5886,-0.6953,-0.6804,-0.4488,0.0076,0.5843,1.0943,1.3433,1.2171,0.7370,0.0558,-0.6053,-1.0497,-1.1830,-1.0398,-0.7487,-0.4584,-0.2625,-0.1641,-0.0930,0.0348,0.2536,0.5159,0.7115,0.7284,0.5224,0.1561,-0.2165,-0.4155,-0.3203,0.0686,0.6219,1.1345,1.4151,1.3701,1.0432,0.5930,0.2181,0.0668,0.1719,0.4389,0.6935,0.7624,0.5542,0.1014,-0.4504,-0.9028,-1.0862,-0.9286,-0.4855,0.0818,0.5682,0.8027,0.7122,0.3468,-0.1414,-0.5582,-0.7427,-0.6284,-0.2683,0.1881,0.5556,0.6899,0.5477,0.2058,-0.1693,-0.3907,-0.3299,0.0280,0.5769,1.1336,1.5135,1.6051,1.4107,1.0371,0.6418,0.3628,0.2650,0.3261,0.4640,0.5890,0.6489,0.6444,0.6099,0.5731,0.5230,0.4069,0.1634,-0.2274,-0.7060,-1.1362,-1.3539,-1.2439,-0.8065,-0.1769,0.4188,0.7559,0.7108,0.3193,-0.2360,-0.7077,-0.8962,-0.7417,-0.3492,0.0639,0.2739,0.1583,-0.2471,-0.7674,-1.1738,-1.2921,-1.0800,-0.6385,-0.1540,0.1966,0.3296,0.2842,0.1878,0.1770,0.3176,0.5652,0.7862,0.8266,0.5923,0.1004,-0.5235,-1.0995,-1.4688,-1.5554,-1.3850,-1.0577,-0.6945,-0.3868,-0.1728,-0.0487,0.0016,-0.0195,-0.1265,-0.3291,-0.6014,-0.8650,-1.0040,-0.9108,-0.5414,0.0478,0.7064,1.2410,1.4919,1.3989,1.0259,0.5301,0.0911,-0.1677,-0.2271,-0.1679,-0.1182,-0.1797,-0.3709,-0.6157,-0.7829,-0.7559,-0.4959,-0.0685,0.3826,0.7006,0.7884,0.6526,0.3987,0.1789,0.1182,0.2547,0.5212,0.7772,0.8745,0.7264,0.3492,-0.1431,-0.5845,-0.8237,-0.7803,-0.4694,0.0133,0.5346,0.9735,1.2569,1.3687,1.3352,1.1995,1.0003,0.7643,0.5133,0.2758,0.0927,0.0086,0.0521,0.2139,0.4381,0.6330,0.7034,0.5899,0.2991,-0.0917,-0.4599,-0.6862,-0.7055,-0.5381,-0.2856,-0.0911,-0.0778,-0.2923,-0.6774,-1.0881,-1.3475,-1.3195,-0.9703,-0.3897,0.2369,0.6981,0.8393,0.6260,0.1613,-0.3522,-0.6894,-0.6902,-0.3221,0.3075,0.9932,1.5099,1.6971,1.5149,1.0509,0.4790,-0.0129,-0.2940,-0.3327,-0.1956,-0.0053,0.1192,0.1159,0.0020,-0.1419,-0.2159,-0.1529,0.0464,0.3105,0.5276,0.5952,0.4674,0.1768,-0.1768,-0.4674,-0.5952,-0.5276,-0.3105,-0.0464,0.1529,0.2159,0.1419,-0.0020,-0.1159,-0.1192,0.0053,0.1956,0.3327,0.2940,0.0129,-0.4790,-1.0509,-1.5149,-1.6971,-1.5099,-0.9932,-0.3075,0.3221,0.6902,0.6894,0.3522,-0.1613,-0.6260,-0.8393,-0.6981,-0.2369,0.3897,0.9703,1.3195,1.3475,1.0881,0.6774,0.2923,0.0778,0.0911,0.2856,0.5381,0.7055,0.6862,0.4599,0.0917,-0.2991,-0.5899,-0.7034,-0.6330,-0.4381,-0.2139,-0.0521,-0.0086,-0.0927,-0.2758,-0.5133,-0.7643,-1.0003,-1.1995,-1.3352,-1.3687,-1.2569,-0.9735,-0.5346,-0.0133,0.4694,0.7803,0.8237,0.5845,0.1431,-0.3492,-0.7264,-0.8745,-0.7772,-0.5212,-0.2547,-0.1182,-0.1789,-0.3987,-0.6526,-0.7884,-0.7006,-0.3826,0.0685,0.4959,0.7559,0.7829,0.6157,0.3709,0.1797,0.1182,0.1679,0.2271,0.1677,-0.0911,-0.5301,-1.0259,-1.3989,-1.4919,-1.2410,-0.7064,-0.0478,0.5414,0.9108,1.0040,0.8650,0.6014,0.3291,0.1265,0.0195,-0.0016,0.0487,0.1728,0.3868,0.6945,1.0577,1.3850,1.5554,1.4688,1.0995,0.5235,-0.1004,-0.5923,-0.8266,-0.7862,-0.5652,-0.3176,-0.1770,-0.1878,-0.2842,-0.3296,-0.1966,0.1540,0.6385,1.0800,1.2921,1.1738,0.7674,0.2471,-0.1583,-0.2739,-0.0639,0.3492,0.7417,0.8962,0.7077,0.2360,-0.3193,-0.7108,-0.7559,-0.4188,0.1769,0.8065,1.2439,1.3539,1.1362,0.7060,0.2274,-0.1634,-0.4069,-0.5230,-0.5731,-0.6099,-0.6444,-0.6489,-0.5890,-0.4640,-0.3261,-0.2650,-0.3628,-0.6418,-1.0371,-1.4107,-1.6051,-1.5135,-1.1336,-0.5769,-0.0280,0.3299,0.3907,0.1693,-0.2058,-0.5477,-0.6899,-0.5556,-0.1881,0.2683,0.6284,0.7427,0.5582,0.1414,-0.3468,-0.7122,-0.8027,-0.5682,-0.0818,0.4855,0.9286,1.0862,0.9028,0.4504,-0.1014,-0.5542,-0.7624,-0.6935,-0.4389,-0.1719,-0.0668,-0.2181,-0.5930,-1.0432,-1.3701,-1.4151,-1.1345,-0.6219,-0.0686,0.3203,0.4155,0.2165,-0.1561,-0.5224,-0.7284,-0.7115,-0.5159,-0.2536,-0.0348,0.0930,0.1641,0.2625,0.4584,0.7487,1.0398,1.1830,1.0497,0.6053,-0.0558,-0.7370,-1.2171,-1.3433,-1.0943,-0.5843,-0.0076,0.4488,0.6804,0.6953,0.5886,0.4803,0.4528,0.5197,0.6372,0.7466,0.8172,0.8625,0.9214,1.0176,1.1248,1.1644,1.0408,0.6987,0.1683,-0.4292,-0.9235,-1.1685,-1.1082,-0.8017,-0.3928,-0.0385,0.1654,0.2241,0.2269,0.2838,0.4528,0.6961,0.8943,0.9099,0.6682,0.2107,-0.3103,-0.6953,-0.7901,-0.5594,-0.1033,0.3895,0.7314,0.8199,0.6769,0.4239,0.2103,0.1323,0.1860,0.2764,0.2741,0.0892,-0.2793,-0.7400,-1.1528,-1.3924,-1.3994,-1.1944,-0.8545,-0.4708,-0.1121,0.1856,0.4065,0.5345,0.5458,0.4248,0.1927,-0.0717,-0.2428,-0.1957,0.1290,0.6751,1.2708,1.6869,1.7345,1.3575,0.6721,-0.0719,-0.5946,-0.7083,-0.4010,0.1612,0.7147,1.0235,0.9876,0.6823,0.3097,0.0893,0.1438,0.4390,0.8070,1.0376,0.9915,0.6735,0.2284,-0.1359,-0.2586,-0.1099,0.1942,0.4543,0.4947,0.2580,-0.1601,-0.5556,-0.7161,-0.5282,-0.0362,0.5727,1.0509,1.1981,0.9448,0.3750,-0.3172,-0.9121,-1.2488,-1.2751,-1.0464,-0.6859,-0.3299,-0.0840,-0.0035,-0.0957,-0.3306,-0.6506,-0.9764,-1.2145,-1.2749,-1.0998,-0.6940,-0.1388,0.4251,0.8440,1.0128,0.9215,0.6629,0.3925,0.2576,0.3268,0.5569,0.8133,0.9375,0.8274,0.4923,0.0532,-0.3116,-0.4497,-0.3050,0.0581,0.4881,0.8185,0.9413,0.8464,0.6092,0.3376,0.1104,-0.0600,-0.2196,-0.4275,-0.7011,-0.9855,-1.1674,-1.1296,-0.8166,-0.2775,0.3416,0.8529,1.1070,1.0565,0.7736,0.4111,0.1275,0.0134,0.0539,0.1470,0.1645,0.0240,-0.2650,-0.6053,-0.8619,-0.9333,-0.8047,-0.5569,-0.3248,-0.2278,-0.3056,-0.4946,-0.6560,-0.6444,-0.3829,0.0910,0.6319,1.0430,1.1576,0.9093,0.3596,-0.3288,-0.9573,-1.3675,-1.4943,-1.3754,-1.1183,-0.8446,-0.6393,-0.5277,-0.4868,-0.4789,-0.4868,-0.5277,-0.6393,-0.8446,-1.1183,-1.3754,-1.4943,-1.3675,-0.9573,-0.3288,0.3596,0.9093,1.1576,1.0430,0.6319,0.0910,-0.3829,-0.6444,-0.6560,-0.4946,-0.3056,-0.2278,-0.3248,-0.5569,-0.8047,-0.9333,-0.8619,-0.6053,-0.2650,0.0240,0.1645,0.1470,0.0539,0.0134,0.1275,0.4111,0.7736,1.0565,1.1070,0.8529,0.3416,-0.2775,-0.8166,-1.1296,-1.1674,-0.9855,-0.7011,-0.4275,-0.2196,-0.0600,0.1104,0.3376,0.6092,0.8464,0.9413,0.8185,0.4881,0.0581,-0.3050,-0.4497,-0.3116,0.0532,0.4923,0.8274,0.9375,0.8133,0.5569,0.3268,0.2576,0.3925,0.6629,0.9215,1.0128,0.8440,0.4251,-0.1388,-0.6940,-1.0998,-1.2749,-1.2145,-0.9764,-0.6506,-0.3306,-0.0957,-0.0035,-0.0840,-0.3299,-0.6859,-1.0464,-1.2751,-1.2488,-0.9121,-0.3172,0.3750,0.9448,1.1981,1.0509,0.5727,-0.0362,-0.5282,-0.7161,-0.5556,-0.1601,0.2580,0.4947,0.4543,0.1942,-0.1099,-0.2586,-0.1359,0.2284,0.6735,0.9915,1.0376,0.8070,0.4390,0.1438,0.0893,0.3097,0.6823,0.9876,1.0235,0.7147,0.1612,-0.4010,-0.7083,-0.5946,-0.0719,0.6721,1.3575,1.7345,1.6869,1.2708,0.6751,0.1290,-0.1957,-0.2428,-0.0717,0.1927,0.4248,0.5458,0.5345,0.4065,0.1856,-0.1121,-0.4708,-0.8545,-1.1944,-1.3994,-1.3924,-1.1528,-0.7400,-0.2793,0.0892,0.2741,0.2764,0.1860,0.1323,0.2103,0.4239,0.6769,0.8199,0.7314,0.3895,-0.1033,-0.5594,-0.7901,-0.6953,-0.3103,0.2107,0.6682,0.9099,0.8943,0.6961,0.4528,0.2838,0.2269,0.2241,0.1654,-0.0385,-0.3928,-0.8017,-1.1082,-1.1685,-0.9235,-0.4292,0.1683,0.6987,1.0408,1.1644,1.1248,1.0176,0.9214,0.8625,0.8172,0.7466,0.6372,0.5197,0.4528,0.4803,0.5886,0.6953,0.6804,0.4488,-0.0076,-0.5843,-1.0943,-1.3433,-1.2171,-0.7370,-0.0558,0.6053,1.0497,1.1830,1.0398,0.7487,0.4584,0.2625,0.1641,0.0930,-0.0348,-0.2536,-0.5159,-0.7115,-0.7284,-0.5224,-0.1561,0.2165,0.4155,0.3203,-0.0686,-0.6219,-1.1345,-1.4151,-1.3701,-1.0432,-0.5930,-0.2181,-0.0668,-0.1719,-0.4389,-0.6935,-0.7624,-0.5542,-0.1014,0.4504,0.9028,1.0862,0.9286,0.4855,-0.0818,-0.5682,-0.8027,-0.7122,-0.3468,0.1414,0.5582,0.7427,0.6284,0.2683,-0.1881,-0.5556,-0.6899,-0.5477,-0.2058,0.1693,0.3907,0.3299,-0.0280,-0.5769,-1.1336,-1.5135,-1.6051,-1.4107,-1.0371,-0.6418,-0.3628,-0.2650,-0.3261,-0.4640,-0.5890,-0.6489,-0.6444,-0.6099,-0.5731,-0.5230,-0.4069,-0.1634,0.2274,0.7060,1.1362,1.3539,1.2439,0.8065,0.1769,-0.4188,-0.7559,-0.7108,-0.3193,0.2360,0.7077,0.8962,0.7417,0.3492,-0.0639,-0.2739,-0.1583,0.2471,0.7674,1.1738,1.2921,1.0800,0.6385,0.1540,-0.1966,-0.3296,-0.2842,-0.1878,-0.1770,-0.3176,-0.5652,-0.7862,-0.8266,-0.5923,-0.1004,0.5235,1.0995,1.4688,1.5554,1.3850,1.0577,0.6945,0.3868,0.1728,0.0487,-0.0016,0.0195,0.1265,0.3291,0.6014,0.8650,1.0040,0.9108,0.5414,-0.0478,-0.7064,-1.2410,-1.4919,-1.3989,-1.0259,-0.5301,-0.0911,0.1677,0.2271,0.1679,0.1182,0.1797,0.3709,0.6157,0.7829,0.7559,0.4959,0.0685,-0.3826,-0.7006,-0.7884,-0.6526,-0.3987,-0.1789,-0.1182,-0.2547,-0.5212,-0.7772,-0.8745,-0.7264,-0.3492,0.1431,0.5845,0.8237,0.7803,0.4694,-0.0133,-0.5346,-0.9735,-1.2569,-1.3687,-1.3352,-1.1995,-1.0003,-0.7643,-0.5133,-0.2758,-0.0927,-0.0086,-0.0521,-0.2139,-0.4381,-0.6330,-0.7034,-0.5899,-0.2991,0.0917,0.4599,0.6862,0.7055,0.5381,0.2856,0.0911,0.0778,0.2923,0.6774,1.0881,1.3475,1.3195,0.9703,0.3897,-0.2369,-0.6981,-0.8393,-0.6260,-0.1613,0.3522,0.6894,0.6902,0.3221,-0.3075,-0.9932,-1.5099,-1.6971,-1.5149,-1.0509,-0.4790,0.0129,0.2940,0.3327,0.1956,0.0053,-0.1192,-0.1159,-0.0020,0.1419,0.2159,0.1529,-0.0464,-0.3105,-0.5276,-0.5952,-0.4674,-0.1768,0.1768,0.4674,0.5952,0.5276,0.3105,0.0464,-0.1529,-0.2159,-0.1419,0.0020,0.1159,0.1192,-0.0053,-0.1956,-0.3327,-0.2940,-0.0129,0.4790,1.0509,1.5149,1.6971,1.5099,0.9932,0.3075,-0.3221,-0.6902,-0.6894,-0.3522,0.1613,0.6260,0.8393,0.6981,0.2369,-0.3897,-0.9703,-1.3195,-1.3475,-1.0881,-0.6774,-0.2923,-0.0778,-0.0911,-0.2856,-0.5381,-0.7055,-0.6862,-0.4599,-0.0917,0.2991,0.5899,0.7034,0.6330,0.4381,0.2139,0.0521,0.0086,0.0927,0.2758,0.5133,0.7643,1.0003,1.1995,1.3352,1.3687,1.2569,0.9735,0.5346,0.0133,-0.4694,-0.7803,-0.8237,-0.5845,-0.1431,0.3492,0.7264,0.8745,0.7772,0.5212,0.2547,0.1182,0.1789,0.3987,0.6526,0.7884,0.7006,0.3826,-0.0685,-0.4959,-0.7559,-0.7829,-0.6157,-0.3709,-0.1797,-0.1182,-0.1679,-0.2271,-0.1677,0.0911,0.5301,1.0259,1.3989,1.4919,1.2410,0.7064,0.0478,-0.5414,-0.9108,-1.0040,-0.8650,-0.6014,-0.3291,-0.1265,-0.0195,0.0016,-0.0487,-0.1728,-0.3868,-0.6945,-1.0577,-1.3850,-1.5554,-1.4688,-1.0995,-0.5235,0.1004,0.5923,0.8266,0.7862,0.5652,0.3176,0.1770,0.1878,0.2842,0.3296,0.1966,-0.1540,-0.6385,-1.0800,-1.2921,-1.1738,-0.7674,-0.2471,0.1583,0.2739,0.0639,-0.3492,-0.7417,-0.8962,-0.7077,-0.2360,0.3193,0.7108,0.7559,0.4188,-0.1769,-0.8065,-1.2439,-1.3539,-1.1362,-0.7060,-0.2274,0.1634,0.4069,0.5230,0.5731,0.6099,0.6444,0.6489,0.5890,0.4640,0.3261,0.2650,0.3628,0.6418,1.0371,1.4107,1.6051,1.5135,1.1336,0.5769,0.0280,-0.3299,-0.3907,-0.1693,0.2058,0.5477,0.6899,0.5556,0.1881,-0.2683,-0.6284,-0.7427,-0.5582,-0.1414,0.3468,0.7122,0.8027,0.5682,0.0818,-0.4855,-0.9286,-1.0862,-0.9028,-0.4504,0.1014,0.5542,0.7624,0.6935,0.4389,0.1719,0.0668,0.2181,0.5930,1.0432,1.3701,1.4151,1.1345,0.6219,0.0686,-0.3203,-0.4155,-0.2165,0.1561,0.5224,0.7284,0.7115,0.5159,0.2536,0.0348,-0.0930,-0.1641,-0.2625,-0.4584,-0.7487,-1.0398,-1.1830,-1.0497,-0.6053,0.0558,0.7370,1.2171,1.3433,1.0943,0.5843,0.0076,-0.4488,-0.6804,-0.6953,-0.5886,-0.4803,-0.4528,-0.5197,-0.6372,-0.7466,-0.8172,-0.8625,-0.9214,-1.0176,-1.1248,-1.1644,-1.0408,-0.6987,-0.1683,0.4292,0.9235,1.1685,1.1082,0.8017,0.3928,0.0385,-0.1654,-0.2241,-0.2269,-0.2838,-0.4528,-0.6961,-0.8943,-0.9099,-0.6682,-0.2107,0.3103,0.6953,0.7901,0.5594,0.1033,-0.3895,-0.7314,-0.8199,-0.6769,-0.4239,-0.2103,-0.1323,-0.1860,-0.2764,-0.2741,-0.0892,0.2793,0.7400,1.1528,1.3924,1.3994,1.1944,0.8545,0.4708,0.1121,-0.1856,-0.4065,-0.5345,-0.5458,-0.4248,-0.1927,0.0717,0.2428,0.1957,-0.1290,-0.6751,-1.2708,-1.6869,-1.7345,-1.3575,-0.6721,0.0719,0.5946,0.7083,0.4010,-0.1612,-0.7147,-1.0235,-0.9876,-0.6823,-0.3097,-0.0893,-0.1438,-0.4390,-0.8070,-1.0376,-0.9915,-0.6735,-0.2284,0.1359,0.2586,0.1099,-0.1942,-0.4543,-0.4947,-0.2580,0.1601,0.5556,0.7161,0.5282,0.0362,-0.5727,-1.0509,-1.1981,-0.9448,-0.3750,0.3172,0.9121,1.2488,1.2751,1.0464,0.6859,0.3299,0.0840,0.0035,0.0957,0.3306,0.6506,0.9764,1.2145,1.2749,1.0998,0.6940,0.1388,-0.4251,-0.8440,-1.0128,-0.9215,-0.6629,-0.3925,-0.2576,-0.3268,-0.5569,-0.8133,-0.9375,-0.8274,-0.4923,-0.0532,0.3116,0.4497,0.3050,-0.0581,-0.4881,-0.8185,-0.9413,-0.8464,-0.6092,-0.3376,-0.1104,0.0600,0.2196,0.4275,0.7011,0.9855,1.1674,1.1296,0.8166,0.2775,-0.3416,-0.8529,-1.1070,-1.0565,-0.7736,-0.4111,-0.1275,-0.0134,-0.0539,-0.1470,-0.1645,-0.0240,0.2650,0.6053,0.8619,0.9333,0.8047,0.5569,0.3248,0.2278,0.3056,0.4946,0.6560,0.6444,0.3829,-0.0910,-0.6319,-1.0430,-1.1576,-0.9093,-0.3596,0.3288,0.9573,1.3675,1.4943,1.3754,1.1183,0.8446,0.6393,0.5277,0.4868,0.4789};
	double excite;	// excitation command, rad
	
	if (i<1798){excite = OMS2_ch1[i] * amp;}
	else {excite = 0.0;}
	return excite;
}

double playback_OMS2_2(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS2_ch2[1799] = {0.4789,0.4870,0.5287,0.6417,0.8483,1.1212,1.3730,1.4805,1.3369,0.9086,0.2674,-0.4221,-0.9583,-1.1805,-1.0353,-0.5995,-0.0481,0.4195,0.6623,0.6526,0.4777,0.2882,0.2206,0.3295,0.5640,0.7980,0.8977,0.7917,0.5079,0.1579,-0.1221,-0.2432,-0.2094,-0.1142,-0.0877,-0.2223,-0.5153,-0.8602,-1.0931,-1.0712,-0.7451,-0.1879,0.4330,0.9282,1.1663,1.1228,0.8755,0.5528,0.2648,0.0543,-0.1076,-0.2829,-0.5091,-0.7600,-0.9485,-0.9715,-0.7745,-0.3962,0.0328,0.3418,0.3986,0.1748,-0.2371,-0.6645,-0.9351,-0.9572,-0.7601,-0.4742,-0.2626,-0.2381,-0.4069,-0.6667,-0.8570,-0.8370,-0.5501,-0.0488,0.5310,1.0282,1.3190,1.3551,1.1670,0.8397,0.4764,0.1701,-0.0106,-0.0271,0.1263,0.4148,0.7574,1.0341,1.1161,0.9138,0.4256,-0.2389,-0.8832,-1.2917,-1.3197,-0.9615,-0.3630,0.2342,0.5957,0.5973,0.2786,-0.1809,-0.5518,-0.6691,-0.5107,-0.2038,0.0469,0.0696,-0.1819,-0.6027,-0.9921,-1.1603,-1.0304,-0.6802,-0.3020,-0.0996,-0.1777,-0.4823,-0.8257,-0.9842,-0.8192,-0.3578,0.2099,0.6176,0.6513,0.2551,-0.4363,-1.1561,-1.6245,-1.6696,-1.2956,-0.6679,-0.0299,0.4059,0.5392,0.4031,0.1247,-0.1466,-0.3026,-0.3043,-0.1699,0.0591,0.3457,0.6642,0.9846,1.2557,1.4037,1.3579,1.0903,0.6452,0.1369,-0.2920,-0.5323,-0.5600,-0.4474,-0.3236,-0.3042,-0.4255,-0.6209,-0.7539,-0.6946,-0.3970,0.0628,0.5117,0.7582,0.6850,0.3086,-0.2255,-0.7102,-0.9723,-0.9478,-0.7002,-0.3748,-0.1154,0.0096,0.0341,0.0610,0.1898,0.4470,0.7587,0.9814,0.9745,0.6755,0.1379,-0.4883,-1.0228,-1.3327,-1.3827,-1.2349,-1.0030,-0.7889,-0.6387,-0.5368,-0.4387,-0.3153,-0.1799,-0.0796,-0.0576,-0.1106,-0.1725,-0.1393,0.0731,0.4701,0.9522,1.3437,1.4662,1.2238,0.6562,-0.0675,-0.7161,-1.0926,-1.1129,-0.8311,-0.4010,0.0054,0.2771,0.4039,0.4580,0.5329,0.6761,0.8542,0.9711,0.9279,0.6907,0.3271,-0.0125,-0.1617,-0.0220,0.3816,0.9017,1.3286,1.4839,1.3004,0.8526,0.3218,-0.0874,-0.2389,-0.1238,0.1403,0.3689,0.3982,0.1622,-0.2757,-0.7499,-1.0638,-1.0747,-0.7550,-0.2057,0.3830,0.8059,0.9216,0.7063,0.2603,-0.2323,-0.5752,-0.6357,-0.3944,0.0493,0.5184,0.8306,0.8730,0.6484,0.2749,-0.0634,-0.1943,-0.0321,0.3845,0.9060,1.3343,1.5047,1.3537,0.9407,0.4181,-0.0379,-0.3011,-0.3402,-0.2176,-0.0459,0.0716,0.0858,0.0102,-0.1071,-0.2263,-0.3470,-0.5053,-0.7397,-1.0456,-1.3498,-1.5272,-1.4557,-1.0869,-0.4914,0.1499,0.6114,0.7208,0.4411,-0.1042,-0.6801,-1.0436,-1.0536,-0.7353,-0.2652,0.1148,0.2143,-0.0140,-0.4537,-0.8829,-1.0827,-0.9409,-0.5014,0.0630,0.5384,0.7722,0.7381,0.5345,0.3196,0.2211,0.2674,0.3766,0.4060,0.2343,-0.1665,-0.7076,-1.2193,-1.5265,-1.5253,-1.2244,-0.7327,-0.2057,0.2215,0.4797,0.5716,0.5444,0.4493,0.3158,0.1527,-0.0279,-0.1863,-0.2504,-0.1420,0.1781,0.6705,1.2105,1.6243,1.7568,1.5404,1.0303,0.3868,-0.1898,-0.5427,-0.6202,-0.4880,-0.2852,-0.1491,-0.1457,-0.2402,-0.3224,-0.2716,-0.0272,0.3714,0.7975,1.0950,1.1539,0.9640,0.6210,0.2817,0.0890,0.1052,0.2837,0.4946,0.5884,0.4704,0.1473,-0.2722,-0.6239,-0.7585,-0.6041,-0.1943,0.3492,0.8661,1.2182,1.3329,1.2156,0.9305,0.5651,0.1957,-0.1298,-0.3899,-0.5755,-0.6769,-0.6816,-0.5858,-0.4096,-0.2059,-0.0514,-0.0212,-0.1549,-0.4327,-0.7730,-1.0586,-1.1827,-1.0946,-0.8261,-0.4831,-0.2041,-0.1009,-0.2070,-0.4579,-0.7122,-0.8102,-0.6437,-0.2085,0.3839,0.9442,1.2787,1.2681,0.9210,0.3753,-0.1514,-0.4466,-0.3875,0.0092,0.5918,1.1322,1.4141,1.3155,0.8535,0.1734,-0.5104,-0.9979,-1.1758,-1.0512,-0.7354,-0.3881,-0.1480,-0.0787,-0.1532,-0.2785,-0.3485,-0.2979,-0.1341,0.0673,0.2001,0.1795,-0.0149,-0.3257,-0.6398,-0.8356,-0.8356,-0.6398,-0.3257,-0.0149,0.1795,0.2001,0.0673,-0.1341,-0.2979,-0.3485,-0.2785,-0.1532,-0.0787,-0.1480,-0.3881,-0.7354,-1.0512,-1.1758,-0.9979,-0.5104,0.1734,0.8535,1.3155,1.4141,1.1322,0.5918,0.0092,-0.3875,-0.4466,-0.1514,0.3753,0.9210,1.2681,1.2787,0.9442,0.3839,-0.2085,-0.6437,-0.8102,-0.7122,-0.4579,-0.2070,-0.1009,-0.2041,-0.4831,-0.8261,-1.0946,-1.1827,-1.0586,-0.7730,-0.4327,-0.1549,-0.0212,-0.0514,-0.2059,-0.4096,-0.5858,-0.6816,-0.6769,-0.5755,-0.3899,-0.1298,0.1957,0.5651,0.9305,1.2156,1.3329,1.2182,0.8661,0.3492,-0.1943,-0.6041,-0.7585,-0.6239,-0.2722,0.1473,0.4704,0.5884,0.4946,0.2837,0.1052,0.0890,0.2817,0.6210,0.9640,1.1539,1.0950,0.7975,0.3714,-0.0272,-0.2716,-0.3224,-0.2402,-0.1457,-0.1491,-0.2852,-0.4880,-0.6202,-0.5427,-0.1898,0.3868,1.0303,1.5404,1.7568,1.6243,1.2105,0.6705,0.1781,-0.1420,-0.2504,-0.1863,-0.0279,0.1527,0.3158,0.4493,0.5444,0.5716,0.4797,0.2215,-0.2057,-0.7327,-1.2244,-1.5253,-1.5265,-1.2193,-0.7076,-0.1665,0.2343,0.4060,0.3766,0.2674,0.2211,0.3196,0.5345,0.7381,0.7722,0.5384,0.0630,-0.5014,-0.9409,-1.0827,-0.8829,-0.4537,-0.0140,0.2143,0.1148,-0.2652,-0.7353,-1.0536,-1.0436,-0.6801,-0.1042,0.4411,0.7208,0.6114,0.1499,-0.4914,-1.0869,-1.4557,-1.5272,-1.3498,-1.0456,-0.7397,-0.5053,-0.3470,-0.2263,-0.1071,0.0102,0.0858,0.0716,-0.0459,-0.2176,-0.3402,-0.3011,-0.0379,0.4181,0.9407,1.3537,1.5047,1.3343,0.9060,0.3845,-0.0321,-0.1943,-0.0634,0.2749,0.6484,0.8730,0.8306,0.5184,0.0493,-0.3944,-0.6357,-0.5752,-0.2323,0.2603,0.7063,0.9216,0.8059,0.3830,-0.2057,-0.7550,-1.0747,-1.0638,-0.7499,-0.2757,0.1622,0.3982,0.3689,0.1403,-0.1238,-0.2389,-0.0874,0.3218,0.8526,1.3004,1.4839,1.3286,0.9017,0.3816,-0.0220,-0.1617,-0.0125,0.3271,0.6907,0.9279,0.9711,0.8542,0.6761,0.5329,0.4580,0.4039,0.2771,0.0054,-0.4010,-0.8311,-1.1129,-1.0926,-0.7161,-0.0675,0.6562,1.2238,1.4662,1.3437,0.9522,0.4701,0.0731,-0.1393,-0.1725,-0.1106,-0.0576,-0.0796,-0.1799,-0.3153,-0.4387,-0.5368,-0.6387,-0.7889,-1.0030,-1.2349,-1.3827,-1.3327,-1.0228,-0.4883,0.1379,0.6755,0.9745,0.9814,0.7587,0.4470,0.1898,0.0610,0.0341,0.0096,-0.1154,-0.3748,-0.7002,-0.9478,-0.9723,-0.7102,-0.2255,0.3086,0.6850,0.7582,0.5117,0.0628,-0.3970,-0.6946,-0.7539,-0.6209,-0.4255,-0.3042,-0.3236,-0.4474,-0.5600,-0.5323,-0.2920,0.1369,0.6452,1.0903,1.3579,1.4037,1.2557,0.9846,0.6642,0.3457,0.0591,-0.1699,-0.3043,-0.3026,-0.1466,0.1247,0.4031,0.5392,0.4059,-0.0299,-0.6679,-1.2956,-1.6696,-1.6245,-1.1561,-0.4363,0.2551,0.6513,0.6176,0.2099,-0.3578,-0.8192,-0.9842,-0.8257,-0.4823,-0.1777,-0.0996,-0.3020,-0.6802,-1.0304,-1.1603,-0.9921,-0.6027,-0.1819,0.0696,0.0469,-0.2038,-0.5107,-0.6691,-0.5518,-0.1809,0.2786,0.5973,0.5957,0.2342,-0.3630,-0.9615,-1.3197,-1.2917,-0.8832,-0.2389,0.4256,0.9138,1.1161,1.0341,0.7574,0.4148,0.1263,-0.0271,-0.0106,0.1701,0.4764,0.8397,1.1670,1.3551,1.3190,1.0282,0.5310,-0.0488,-0.5501,-0.8370,-0.8570,-0.6667,-0.4069,-0.2381,-0.2626,-0.4742,-0.7601,-0.9572,-0.9351,-0.6645,-0.2371,0.1748,0.3986,0.3418,0.0328,-0.3962,-0.7745,-0.9715,-0.9485,-0.7600,-0.5091,-0.2829,-0.1076,0.0543,0.2648,0.5528,0.8755,1.1228,1.1663,0.9282,0.4330,-0.1879,-0.7451,-1.0712,-1.0931,-0.8602,-0.5153,-0.2223,-0.0877,-0.1142,-0.2094,-0.2432,-0.1221,0.1579,0.5079,0.7917,0.8977,0.7980,0.5640,0.3295,0.2206,0.2882,0.4777,0.6526,0.6623,0.4195,-0.0481,-0.5995,-1.0353,-1.1805,-0.9583,-0.4221,0.2674,0.9086,1.3369,1.4805,1.3730,1.1212,0.8483,0.6417,0.5287,0.4870,0.4789,0.4870,0.5287,0.6417,0.8483,1.1212,1.3730,1.4805,1.3369,0.9086,0.2674,-0.4221,-0.9583,-1.1805,-1.0353,-0.5995,-0.0481,0.4195,0.6623,0.6526,0.4777,0.2882,0.2206,0.3295,0.5640,0.7980,0.8977,0.7917,0.5079,0.1579,-0.1221,-0.2432,-0.2094,-0.1142,-0.0877,-0.2223,-0.5153,-0.8602,-1.0931,-1.0712,-0.7451,-0.1879,0.4330,0.9282,1.1663,1.1228,0.8755,0.5528,0.2648,0.0543,-0.1076,-0.2829,-0.5091,-0.7600,-0.9485,-0.9715,-0.7745,-0.3962,0.0328,0.3418,0.3986,0.1748,-0.2371,-0.6645,-0.9351,-0.9572,-0.7601,-0.4742,-0.2626,-0.2381,-0.4069,-0.6667,-0.8570,-0.8370,-0.5501,-0.0488,0.5310,1.0282,1.3190,1.3551,1.1670,0.8397,0.4764,0.1701,-0.0106,-0.0271,0.1263,0.4148,0.7574,1.0341,1.1161,0.9138,0.4256,-0.2389,-0.8832,-1.2917,-1.3197,-0.9615,-0.3630,0.2342,0.5957,0.5973,0.2786,-0.1809,-0.5518,-0.6691,-0.5107,-0.2038,0.0469,0.0696,-0.1819,-0.6027,-0.9921,-1.1603,-1.0304,-0.6802,-0.3020,-0.0996,-0.1777,-0.4823,-0.8257,-0.9842,-0.8192,-0.3578,0.2099,0.6176,0.6513,0.2551,-0.4363,-1.1561,-1.6245,-1.6696,-1.2956,-0.6679,-0.0299,0.4059,0.5392,0.4031,0.1247,-0.1466,-0.3026,-0.3043,-0.1699,0.0591,0.3457,0.6642,0.9846,1.2557,1.4037,1.3579,1.0903,0.6452,0.1369,-0.2920,-0.5323,-0.5600,-0.4474,-0.3236,-0.3042,-0.4255,-0.6209,-0.7539,-0.6946,-0.3970,0.0628,0.5117,0.7582,0.6850,0.3086,-0.2255,-0.7102,-0.9723,-0.9478,-0.7002,-0.3748,-0.1154,0.0096,0.0341,0.0610,0.1898,0.4470,0.7587,0.9814,0.9745,0.6755,0.1379,-0.4883,-1.0228,-1.3327,-1.3827,-1.2349,-1.0030,-0.7889,-0.6387,-0.5368,-0.4387,-0.3153,-0.1799,-0.0796,-0.0576,-0.1106,-0.1725,-0.1393,0.0731,0.4701,0.9522,1.3437,1.4662,1.2238,0.6562,-0.0675,-0.7161,-1.0926,-1.1129,-0.8311,-0.4010,0.0054,0.2771,0.4039,0.4580,0.5329,0.6761,0.8542,0.9711,0.9279,0.6907,0.3271,-0.0125,-0.1617,-0.0220,0.3816,0.9017,1.3286,1.4839,1.3004,0.8526,0.3218,-0.0874,-0.2389,-0.1238,0.1403,0.3689,0.3982,0.1622,-0.2757,-0.7499,-1.0638,-1.0747,-0.7550,-0.2057,0.3830,0.8059,0.9216,0.7063,0.2603,-0.2323,-0.5752,-0.6357,-0.3944,0.0493,0.5184,0.8306,0.8730,0.6484,0.2749,-0.0634,-0.1943,-0.0321,0.3845,0.9060,1.3343,1.5047,1.3537,0.9407,0.4181,-0.0379,-0.3011,-0.3402,-0.2176,-0.0459,0.0716,0.0858,0.0102,-0.1071,-0.2263,-0.3470,-0.5053,-0.7397,-1.0456,-1.3498,-1.5272,-1.4557,-1.0869,-0.4914,0.1499,0.6114,0.7208,0.4411,-0.1042,-0.6801,-1.0436,-1.0536,-0.7353,-0.2652,0.1148,0.2143,-0.0140,-0.4537,-0.8829,-1.0827,-0.9409,-0.5014,0.0630,0.5384,0.7722,0.7381,0.5345,0.3196,0.2211,0.2674,0.3766,0.4060,0.2343,-0.1665,-0.7076,-1.2193,-1.5265,-1.5253,-1.2244,-0.7327,-0.2057,0.2215,0.4797,0.5716,0.5444,0.4493,0.3158,0.1527,-0.0279,-0.1863,-0.2504,-0.1420,0.1781,0.6705,1.2105,1.6243,1.7568,1.5404,1.0303,0.3868,-0.1898,-0.5427,-0.6202,-0.4880,-0.2852,-0.1491,-0.1457,-0.2402,-0.3224,-0.2716,-0.0272,0.3714,0.7975,1.0950,1.1539,0.9640,0.6210,0.2817,0.0890,0.1052,0.2837,0.4946,0.5884,0.4704,0.1473,-0.2722,-0.6239,-0.7585,-0.6041,-0.1943,0.3492,0.8661,1.2182,1.3329,1.2156,0.9305,0.5651,0.1957,-0.1298,-0.3899,-0.5755,-0.6769,-0.6816,-0.5858,-0.4096,-0.2059,-0.0514,-0.0212,-0.1549,-0.4327,-0.7730,-1.0586,-1.1827,-1.0946,-0.8261,-0.4831,-0.2041,-0.1009,-0.2070,-0.4579,-0.7122,-0.8102,-0.6437,-0.2085,0.3839,0.9442,1.2787,1.2681,0.9210,0.3753,-0.1514,-0.4466,-0.3875,0.0092,0.5918,1.1322,1.4141,1.3155,0.8535,0.1734,-0.5104,-0.9979,-1.1758,-1.0512,-0.7354,-0.3881,-0.1480,-0.0787,-0.1532,-0.2785,-0.3485,-0.2979,-0.1341,0.0673,0.2001,0.1795,-0.0149,-0.3257,-0.6398,-0.8356,-0.8356,-0.6398,-0.3257,-0.0149,0.1795,0.2001,0.0673,-0.1341,-0.2979,-0.3485,-0.2785,-0.1532,-0.0787,-0.1480,-0.3881,-0.7354,-1.0512,-1.1758,-0.9979,-0.5104,0.1734,0.8535,1.3155,1.4141,1.1322,0.5918,0.0092,-0.3875,-0.4466,-0.1514,0.3753,0.9210,1.2681,1.2787,0.9442,0.3839,-0.2085,-0.6437,-0.8102,-0.7122,-0.4579,-0.2070,-0.1009,-0.2041,-0.4831,-0.8261,-1.0946,-1.1827,-1.0586,-0.7730,-0.4327,-0.1549,-0.0212,-0.0514,-0.2059,-0.4096,-0.5858,-0.6816,-0.6769,-0.5755,-0.3899,-0.1298,0.1957,0.5651,0.9305,1.2156,1.3329,1.2182,0.8661,0.3492,-0.1943,-0.6041,-0.7585,-0.6239,-0.2722,0.1473,0.4704,0.5884,0.4946,0.2837,0.1052,0.0890,0.2817,0.6210,0.9640,1.1539,1.0950,0.7975,0.3714,-0.0272,-0.2716,-0.3224,-0.2402,-0.1457,-0.1491,-0.2852,-0.4880,-0.6202,-0.5427,-0.1898,0.3868,1.0303,1.5404,1.7568,1.6243,1.2105,0.6705,0.1781,-0.1420,-0.2504,-0.1863,-0.0279,0.1527,0.3158,0.4493,0.5444,0.5716,0.4797,0.2215,-0.2057,-0.7327,-1.2244,-1.5253,-1.5265,-1.2193,-0.7076,-0.1665,0.2343,0.4060,0.3766,0.2674,0.2211,0.3196,0.5345,0.7381,0.7722,0.5384,0.0630,-0.5014,-0.9409,-1.0827,-0.8829,-0.4537,-0.0140,0.2143,0.1148,-0.2652,-0.7353,-1.0536,-1.0436,-0.6801,-0.1042,0.4411,0.7208,0.6114,0.1499,-0.4914,-1.0869,-1.4557,-1.5272,-1.3498,-1.0456,-0.7397,-0.5053,-0.3470,-0.2263,-0.1071,0.0102,0.0858,0.0716,-0.0459,-0.2176,-0.3402,-0.3011,-0.0379,0.4181,0.9407,1.3537,1.5047,1.3343,0.9060,0.3845,-0.0321,-0.1943,-0.0634,0.2749,0.6484,0.8730,0.8306,0.5184,0.0493,-0.3944,-0.6357,-0.5752,-0.2323,0.2603,0.7063,0.9216,0.8059,0.3830,-0.2057,-0.7550,-1.0747,-1.0638,-0.7499,-0.2757,0.1622,0.3982,0.3689,0.1403,-0.1238,-0.2389,-0.0874,0.3218,0.8526,1.3004,1.4839,1.3286,0.9017,0.3816,-0.0220,-0.1617,-0.0125,0.3271,0.6907,0.9279,0.9711,0.8542,0.6761,0.5329,0.4580,0.4039,0.2771,0.0054,-0.4010,-0.8311,-1.1129,-1.0926,-0.7161,-0.0675,0.6562,1.2238,1.4662,1.3437,0.9522,0.4701,0.0731,-0.1393,-0.1725,-0.1106,-0.0576,-0.0796,-0.1799,-0.3153,-0.4387,-0.5368,-0.6387,-0.7889,-1.0030,-1.2349,-1.3827,-1.3327,-1.0228,-0.4883,0.1379,0.6755,0.9745,0.9814,0.7587,0.4470,0.1898,0.0610,0.0341,0.0096,-0.1154,-0.3748,-0.7002,-0.9478,-0.9723,-0.7102,-0.2255,0.3086,0.6850,0.7582,0.5117,0.0628,-0.3970,-0.6946,-0.7539,-0.6209,-0.4255,-0.3042,-0.3236,-0.4474,-0.5600,-0.5323,-0.2920,0.1369,0.6452,1.0903,1.3579,1.4037,1.2557,0.9846,0.6642,0.3457,0.0591,-0.1699,-0.3043,-0.3026,-0.1466,0.1247,0.4031,0.5392,0.4059,-0.0299,-0.6679,-1.2956,-1.6696,-1.6245,-1.1561,-0.4363,0.2551,0.6513,0.6176,0.2099,-0.3578,-0.8192,-0.9842,-0.8257,-0.4823,-0.1777,-0.0996,-0.3020,-0.6802,-1.0304,-1.1603,-0.9921,-0.6027,-0.1819,0.0696,0.0469,-0.2038,-0.5107,-0.6691,-0.5518,-0.1809,0.2786,0.5973,0.5957,0.2342,-0.3630,-0.9615,-1.3197,-1.2917,-0.8832,-0.2389,0.4256,0.9138,1.1161,1.0341,0.7574,0.4148,0.1263,-0.0271,-0.0106,0.1701,0.4764,0.8397,1.1670,1.3551,1.3190,1.0282,0.5310,-0.0488,-0.5501,-0.8370,-0.8570,-0.6667,-0.4069,-0.2381,-0.2626,-0.4742,-0.7601,-0.9572,-0.9351,-0.6645,-0.2371,0.1748,0.3986,0.3418,0.0328,-0.3962,-0.7745,-0.9715,-0.9485,-0.7600,-0.5091,-0.2829,-0.1076,0.0543,0.2648,0.5528,0.8755,1.1228,1.1663,0.9282,0.4330,-0.1879,-0.7451,-1.0712,-1.0931,-0.8602,-0.5153,-0.2223,-0.0877,-0.1142,-0.2094,-0.2432,-0.1221,0.1579,0.5079,0.7917,0.8977,0.7980,0.5640,0.3295,0.2206,0.2882,0.4777,0.6526,0.6623,0.4195,-0.0481,-0.5995,-1.0353,-1.1805,-0.9583,-0.4221,0.2674,0.9086,1.3369,1.4805,1.3730,1.1212,0.8483,0.6417,0.5287,0.4870,0.4789};
	double excite;	// excitation command, rad
		
	if (i<1798){ excite = OMS2_ch2[i] * amp;}
	else {excite = 0.0;}
	return excite;
}

// 4 Channel OMS 0.8 Hz to 18.5 Hz
double playback_OMS4_1(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS4_ch1[1799] = {0.9439,0.8776,0.7194,0.5683,0.5268,0.6400,0.8625,1.0706,1.1184,0.9114,0.4628,-0.0970,-0.5656,-0.7534,-0.5686,-0.0657,0.5685,1.0867,1.2831,1.0792,0.5577,-0.0721,-0.5630,-0.7331,-0.5394,-0.0907,0.4042,0.7285,0.7469,0.4557,-0.0270,-0.5210,-0.8648,-0.9783,-0.8831,-0.6750,-0.4676,-0.3355,-0.2855,-0.2637,-0.1931,-0.0172,0.2696,0.6205,0.9583,1.2081,1.3227,1.2914,1.1319,0.8754,0.5559,0.2096,-0.1190,-0.3739,-0.4955,-0.4407,-0.2086,0.1449,0.5128,0.7672,0.8036,0.5813,0.1420,-0.4032,-0.9121,-1.2614,-1.3853,-1.2910,-1.0455,-0.7444,-0.4748,-0.2892,-0.1958,-0.1656,-0.1495,-0.0981,0.0205,0.2092,0.4365,0.6411,0.7474,0.6913,0.4502,0.0651,-0.3577,-0.6750,-0.7581,-0.5494,-0.0997,0.4382,0.8617,1.0013,0.7965,0.3306,-0.1989,-0.5639,-0.6095,-0.3284,0.1296,0.5233,0.6309,0.3551,-0.2267,-0.8945,-1.3846,-1.5093,-1.2409,-0.7195,-0.1838,0.1412,0.1434,-0.1364,-0.5398,-0.8790,-1.0299,-0.9827,-0.8260,-0.6802,-0.6185,-0.6217,-0.5925,-0.4191,-0.0535,0.4426,0.9110,1.1652,1.0796,0.6522,0.0102,-0.6459,-1.1297,-1.3433,-1.3033,-1.1104,-0.8828,-0.6944,-0.5498,-0.4064,-0.2249,-0.0128,0.1686,0.2405,0.1655,-0.0105,-0.1614,-0.1381,0.1495,0.6679,1.2533,1.6731,1.7315,1.3667,0.6907,-0.0521,-0.5909,-0.7479,-0.5137,-0.0420,0.4320,0.7082,0.7125,0.5195,0.2982,0.2118,0.3273,0.5825,0.8246,0.8988,0.7358,0.3917,0.0172,-0.2251,-0.2505,-0.0988,0.0876,0.1440,-0.0221,-0.3716,-0.7457,-0.9422,-0.8206,-0.3808,0.2239,0.7500,0.9711,0.7798,0.2355,-0.4636,-1.0677,-1.3819,-1.3410,-1.0241,-0.6064,-0.2758,-0.1556,-0.2640,-0.5229,-0.8054,-0.9920,-1.0131,-0.8620,-0.5799,-0.2296,0.1289,0.4509,0.7068,0.8772,0.9490,0.9170,0.7868,0.5757,0.3087,0.0116,-0.2936,-0.5879,-0.8486,-1.0427,-1.1284,-1.0675,-0.8462,-0.4937,-0.0864,0.2680,0.4656,0.4444,0.2109,-0.1587,-0.5450,-0.8272,-0.9240,-0.8162,-0.5436,-0.1818,0.1892,0.5092,0.7466,0.8927,0.9491,0.9181,0.8003,0.5997,0.3293,0.0131,-0.3171,-0.6283,-0.8902,-1.0751,-1.1570,-1.1132,-0.9342,-0.6383,-0.2823,0.0437,0.2413,0.2450,0.0605,-0.2212,-0.4486,-0.4693,-0.2025,0.3118,0.9126,1.3761,1.5097,1.2406,0.6568,-0.0238,-0.5437,-0.7169,-0.5078,-0.0412,0.4628,0.7949,0.8534,0.6826,0.4374,0.2931,0.3499,0.5811,0.8520,0.9971,0.9131,0.6170,0.2371,-0.0576,-0.1511,-0.0444,0.1447,0.2494,0.1509,-0.1463,-0.5055,-0.7230,-0.6347,-0.2110,0.4133,0.9902,1.2693,1.1131,0.5614,-0.1881,-0.8707,-1.2721,-1.3160,-1.0807,-0.7442,-0.4891,-0.4194,-0.5269,-0.7191,-0.8845,-0.9559,-0.9348,-0.8695,-0.8047,-0.7382,-0.6147,-0.3625,0.0474,0.5583,1.0300,1.2911,1.2196,0.8075,0.1755,-0.4744,-0.9460,-1.1317,-1.0511,-0.8244,-0.5997,-0.4715,-0.4371,-0.4119,-0.2942,-0.0403,0.2935,0.5700,0.6425,0.4422,0.0315,-0.4083,-0.6557,-0.5551,-0.0989,0.5577,1.1616,1.4746,1.3832,0.9503,0.3850,-0.0547,-0.1806,0.0419,0.4838,0.9169,1.1214,0.9846,0.5471,-0.0216,-0.5014,-0.7169,-0.6054,-0.2320,0.2481,0.6589,0.8706,0.8387,0.6044,0.2638,-0.0751,-0.3300,-0.4636,-0.4843,-0.4327,-0.3628,-0.3227,-0.3390,-0.4069,-0.4881,-0.5198,-0.4354,-0.1918,0.2058,0.6934,1.1599,1.4813,1.5644,1.3842,0.9973,0.5246,0.1092,-0.1330,-0.1496,0.0377,0.3512,0.6918,0.9731,1.1416,1.1780,1.0857,0.8785,0.5752,0.2046,-0.1877,-0.5402,-0.7887,-0.8903,-0.8449,-0.6999,-0.5324,-0.4134,-0.3707,-0.3718,-0.3375,-0.1846,0.1224,0.5382,0.9419,1.1833,1.1524,0.8395,0.3536,-0.1119,-0.3580,-0.2672,0.1384,0.6991,1.1801,1.3698,1.1719,0.6494,0.0007,-0.5221,-0.7174,-0.5160,-0.0058,0.6104,1.1020,1.3057,1.1851,0.8330,0.4188,0.1076,-0.0107,0.0488,0.1882,0.2847,0.2568,0.1030,-0.1030,-0.2568,-0.2847,-0.1882,-0.0488,0.0107,-0.1076,-0.4188,-0.8330,-1.1851,-1.3057,-1.1020,-0.6104,0.0058,0.5160,0.7174,0.5221,-0.0007,-0.6494,-1.1719,-1.3698,-1.1801,-0.6991,-0.1384,0.2672,0.3580,0.1119,-0.3536,-0.8395,-1.1524,-1.1833,-0.9419,-0.5382,-0.1224,0.1846,0.3375,0.3718,0.3707,0.4134,0.5324,0.6999,0.8449,0.8903,0.7887,0.5402,0.1877,-0.2046,-0.5752,-0.8785,-1.0857,-1.1780,-1.1416,-0.9731,-0.6918,-0.3512,-0.0377,0.1496,0.1330,-0.1092,-0.5246,-0.9973,-1.3842,-1.5644,-1.4813,-1.1599,-0.6934,-0.2058,0.1918,0.4354,0.5198,0.4881,0.4069,0.3390,0.3227,0.3628,0.4327,0.4843,0.4636,0.3300,0.0751,-0.2638,-0.6044,-0.8387,-0.8706,-0.6589,-0.2481,0.2320,0.6054,0.7169,0.5014,0.0216,-0.5471,-0.9846,-1.1214,-0.9169,-0.4838,-0.0419,0.1806,0.0547,-0.3850,-0.9503,-1.3832,-1.4746,-1.1616,-0.5577,0.0989,0.5551,0.6557,0.4083,-0.0315,-0.4422,-0.6425,-0.5700,-0.2935,0.0403,0.2942,0.4119,0.4371,0.4715,0.5997,0.8244,1.0511,1.1317,0.9460,0.4744,-0.1755,-0.8075,-1.2196,-1.2911,-1.0300,-0.5583,-0.0474,0.3625,0.6147,0.7382,0.8047,0.8695,0.9348,0.9559,0.8845,0.7191,0.5269,0.4194,0.4891,0.7442,1.0807,1.3160,1.2721,0.8707,0.1881,-0.5614,-1.1131,-1.2693,-0.9902,-0.4133,0.2110,0.6347,0.7230,0.5055,0.1463,-0.1509,-0.2494,-0.1447,0.0444,0.1511,0.0576,-0.2371,-0.6170,-0.9131,-0.9971,-0.8520,-0.5811,-0.3499,-0.2931,-0.4374,-0.6826,-0.8534,-0.7949,-0.4628,0.0412,0.5078,0.7169,0.5437,0.0238,-0.6568,-1.2406,-1.5097,-1.3761,-0.9126,-0.3118,0.2025,0.4693,0.4486,0.2212,-0.0605,-0.2450,-0.2413,-0.0437,0.2823,0.6383,0.9342,1.1132,1.1570,1.0751,0.8902,0.6283,0.3171,-0.0131,-0.3293,-0.5997,-0.8003,-0.9181,-0.9491,-0.8927,-0.7466,-0.5092,-0.1892,0.1818,0.5436,0.8162,0.9240,0.8272,0.5450,0.1587,-0.2109,-0.4444,-0.4656,-0.2680,0.0864,0.4937,0.8462,1.0675,1.1284,1.0427,0.8486,0.5879,0.2936,-0.0116,-0.3087,-0.5757,-0.7868,-0.9170,-0.9490,-0.8772,-0.7068,-0.4509,-0.1289,0.2296,0.5799,0.8620,1.0131,0.9920,0.8054,0.5229,0.2640,0.1556,0.2758,0.6064,1.0241,1.3410,1.3819,1.0677,0.4636,-0.2355,-0.7798,-0.9711,-0.7500,-0.2239,0.3808,0.8206,0.9422,0.7457,0.3716,0.0221,-0.1440,-0.0876,0.0988,0.2505,0.2251,-0.0172,-0.3917,-0.7358,-0.8988,-0.8246,-0.5825,-0.3273,-0.2118,-0.2982,-0.5195,-0.7125,-0.7082,-0.4320,0.0420,0.5137,0.7479,0.5909,0.0521,-0.6907,-1.3667,-1.7315,-1.6731,-1.2533,-0.6679,-0.1495,0.1381,0.1614,0.0105,-0.1655,-0.2405,-0.1686,0.0128,0.2249,0.4064,0.5498,0.6944,0.8828,1.1104,1.3033,1.3433,1.1297,0.6459,-0.0102,-0.6522,-1.0796,-1.1652,-0.9110,-0.4426,0.0535,0.4191,0.5925,0.6217,0.6185,0.6802,0.8260,0.9827,1.0299,0.8790,0.5398,0.1364,-0.1434,-0.1412,0.1838,0.7195,1.2409,1.5093,1.3846,0.8945,0.2267,-0.3551,-0.6309,-0.5233,-0.1296,0.3284,0.6095,0.5639,0.1989,-0.3306,-0.7965,-1.0013,-0.8617,-0.4382,0.0997,0.5494,0.7581,0.6750,0.3577,-0.0651,-0.4502,-0.6913,-0.7474,-0.6411,-0.4365,-0.2092,-0.0205,0.0981,0.1495,0.1656,0.1958,0.2892,0.4748,0.7444,1.0455,1.2910,1.3853,1.2614,0.9121,0.4032,-0.1420,-0.5813,-0.8036,-0.7672,-0.5128,-0.1449,0.2086,0.4407,0.4955,0.3739,0.1190,-0.2096,-0.5559,-0.8754,-1.1319,-1.2914,-1.3227,-1.2081,-0.9583,-0.6205,-0.2696,0.0172,0.1931,0.2637,0.2855,0.3355,0.4676,0.6750,0.8831,0.9783,0.8648,0.5210,0.0270,-0.4557,-0.7469,-0.7285,-0.4042,0.0907,0.5394,0.7331,0.5630,0.0721,-0.5577,-1.0792,-1.2831,-1.0867,-0.5685,0.0657,0.5686,0.7534,0.5656,0.0970,-0.4628,-0.9114,-1.1184,-1.0706,-0.8625,-0.6400,-0.5268,-0.5683,-0.7194,-0.8776,-0.9439,-0.8776,-0.7194,-0.5683,-0.5268,-0.6400,-0.8625,-1.0706,-1.1184,-0.9114,-0.4628,0.0970,0.5656,0.7534,0.5686,0.0657,-0.5685,-1.0867,-1.2831,-1.0792,-0.5577,0.0721,0.5630,0.7331,0.5394,0.0907,-0.4042,-0.7285,-0.7469,-0.4557,0.0270,0.5210,0.8648,0.9783,0.8831,0.6750,0.4676,0.3355,0.2855,0.2637,0.1931,0.0172,-0.2696,-0.6205,-0.9583,-1.2081,-1.3227,-1.2914,-1.1319,-0.8754,-0.5559,-0.2096,0.1190,0.3739,0.4955,0.4407,0.2086,-0.1449,-0.5128,-0.7672,-0.8036,-0.5813,-0.1420,0.4032,0.9121,1.2614,1.3853,1.2910,1.0455,0.7444,0.4748,0.2892,0.1958,0.1656,0.1495,0.0981,-0.0205,-0.2092,-0.4365,-0.6411,-0.7474,-0.6913,-0.4502,-0.0651,0.3577,0.6750,0.7581,0.5494,0.0997,-0.4382,-0.8617,-1.0013,-0.7965,-0.3306,0.1989,0.5639,0.6095,0.3284,-0.1296,-0.5233,-0.6309,-0.3551,0.2267,0.8945,1.3846,1.5093,1.2409,0.7195,0.1838,-0.1412,-0.1434,0.1364,0.5398,0.8790,1.0299,0.9827,0.8260,0.6802,0.6185,0.6217,0.5925,0.4191,0.0535,-0.4426,-0.9110,-1.1652,-1.0796,-0.6522,-0.0102,0.6459,1.1297,1.3433,1.3033,1.1104,0.8828,0.6944,0.5498,0.4064,0.2249,0.0128,-0.1686,-0.2405,-0.1655,0.0105,0.1614,0.1381,-0.1495,-0.6679,-1.2533,-1.6731,-1.7315,-1.3667,-0.6907,0.0521,0.5909,0.7479,0.5137,0.0420,-0.4320,-0.7082,-0.7125,-0.5195,-0.2982,-0.2118,-0.3273,-0.5825,-0.8246,-0.8988,-0.7358,-0.3917,-0.0172,0.2251,0.2505,0.0988,-0.0876,-0.1440,0.0221,0.3716,0.7457,0.9422,0.8206,0.3808,-0.2239,-0.7500,-0.9711,-0.7798,-0.2355,0.4636,1.0677,1.3819,1.3410,1.0241,0.6064,0.2758,0.1556,0.2640,0.5229,0.8054,0.9920,1.0131,0.8620,0.5799,0.2296,-0.1289,-0.4509,-0.7068,-0.8772,-0.9490,-0.9170,-0.7868,-0.5757,-0.3087,-0.0116,0.2936,0.5879,0.8486,1.0427,1.1284,1.0675,0.8462,0.4937,0.0864,-0.2680,-0.4656,-0.4444,-0.2109,0.1587,0.5450,0.8272,0.9240,0.8162,0.5436,0.1818,-0.1892,-0.5092,-0.7466,-0.8927,-0.9491,-0.9181,-0.8003,-0.5997,-0.3293,-0.0131,0.3171,0.6283,0.8902,1.0751,1.1570,1.1132,0.9342,0.6383,0.2823,-0.0437,-0.2413,-0.2450,-0.0605,0.2212,0.4486,0.4693,0.2025,-0.3118,-0.9126,-1.3761,-1.5097,-1.2406,-0.6568,0.0238,0.5437,0.7169,0.5078,0.0412,-0.4628,-0.7949,-0.8534,-0.6826,-0.4374,-0.2931,-0.3499,-0.5811,-0.8520,-0.9971,-0.9131,-0.6170,-0.2371,0.0576,0.1511,0.0444,-0.1447,-0.2494,-0.1509,0.1463,0.5055,0.7230,0.6347,0.2110,-0.4133,-0.9902,-1.2693,-1.1131,-0.5614,0.1881,0.8707,1.2721,1.3160,1.0807,0.7442,0.4891,0.4194,0.5269,0.7191,0.8845,0.9559,0.9348,0.8695,0.8047,0.7382,0.6147,0.3625,-0.0474,-0.5583,-1.0300,-1.2911,-1.2196,-0.8075,-0.1755,0.4744,0.9460,1.1317,1.0511,0.8244,0.5997,0.4715,0.4371,0.4119,0.2942,0.0403,-0.2935,-0.5700,-0.6425,-0.4422,-0.0315,0.4083,0.6557,0.5551,0.0989,-0.5577,-1.1616,-1.4746,-1.3832,-0.9503,-0.3850,0.0547,0.1806,-0.0419,-0.4838,-0.9169,-1.1214,-0.9846,-0.5471,0.0216,0.5014,0.7169,0.6054,0.2320,-0.2481,-0.6589,-0.8706,-0.8387,-0.6044,-0.2638,0.0751,0.3300,0.4636,0.4843,0.4327,0.3628,0.3227,0.3390,0.4069,0.4881,0.5198,0.4354,0.1918,-0.2058,-0.6934,-1.1599,-1.4813,-1.5644,-1.3842,-0.9973,-0.5246,-0.1092,0.1330,0.1496,-0.0377,-0.3512,-0.6918,-0.9731,-1.1416,-1.1780,-1.0857,-0.8785,-0.5752,-0.2046,0.1877,0.5402,0.7887,0.8903,0.8449,0.6999,0.5324,0.4134,0.3707,0.3718,0.3375,0.1846,-0.1224,-0.5382,-0.9419,-1.1833,-1.1524,-0.8395,-0.3536,0.1119,0.3580,0.2672,-0.1384,-0.6991,-1.1801,-1.3698,-1.1719,-0.6494,-0.0007,0.5221,0.7174,0.5160,0.0058,-0.6104,-1.1020,-1.3057,-1.1851,-0.8330,-0.4188,-0.1076,0.0107,-0.0488,-0.1882,-0.2847,-0.2568,-0.1030,0.1030,0.2568,0.2847,0.1882,0.0488,-0.0107,0.1076,0.4188,0.8330,1.1851,1.3057,1.1020,0.6104,-0.0058,-0.5160,-0.7174,-0.5221,0.0007,0.6494,1.1719,1.3698,1.1801,0.6991,0.1384,-0.2672,-0.3580,-0.1119,0.3536,0.8395,1.1524,1.1833,0.9419,0.5382,0.1224,-0.1846,-0.3375,-0.3718,-0.3707,-0.4134,-0.5324,-0.6999,-0.8449,-0.8903,-0.7887,-0.5402,-0.1877,0.2046,0.5752,0.8785,1.0857,1.1780,1.1416,0.9731,0.6918,0.3512,0.0377,-0.1496,-0.1330,0.1092,0.5246,0.9973,1.3842,1.5644,1.4813,1.1599,0.6934,0.2058,-0.1918,-0.4354,-0.5198,-0.4881,-0.4069,-0.3390,-0.3227,-0.3628,-0.4327,-0.4843,-0.4636,-0.3300,-0.0751,0.2638,0.6044,0.8387,0.8706,0.6589,0.2481,-0.2320,-0.6054,-0.7169,-0.5014,-0.0216,0.5471,0.9846,1.1214,0.9169,0.4838,0.0419,-0.1806,-0.0547,0.3850,0.9503,1.3832,1.4746,1.1616,0.5577,-0.0989,-0.5551,-0.6557,-0.4083,0.0315,0.4422,0.6425,0.5700,0.2935,-0.0403,-0.2942,-0.4119,-0.4371,-0.4715,-0.5997,-0.8244,-1.0511,-1.1317,-0.9460,-0.4744,0.1755,0.8075,1.2196,1.2911,1.0300,0.5583,0.0474,-0.3625,-0.6147,-0.7382,-0.8047,-0.8695,-0.9348,-0.9559,-0.8845,-0.7191,-0.5269,-0.4194,-0.4891,-0.7442,-1.0807,-1.3160,-1.2721,-0.8707,-0.1881,0.5614,1.1131,1.2693,0.9902,0.4133,-0.2110,-0.6347,-0.7230,-0.5055,-0.1463,0.1509,0.2494,0.1447,-0.0444,-0.1511,-0.0576,0.2371,0.6170,0.9131,0.9971,0.8520,0.5811,0.3499,0.2931,0.4374,0.6826,0.8534,0.7949,0.4628,-0.0412,-0.5078,-0.7169,-0.5437,-0.0238,0.6568,1.2406,1.5097,1.3761,0.9126,0.3118,-0.2025,-0.4693,-0.4486,-0.2212,0.0605,0.2450,0.2413,0.0437,-0.2823,-0.6383,-0.9342,-1.1132,-1.1570,-1.0751,-0.8902,-0.6283,-0.3171,0.0131,0.3293,0.5997,0.8003,0.9181,0.9491,0.8927,0.7466,0.5092,0.1892,-0.1818,-0.5436,-0.8162,-0.9240,-0.8272,-0.5450,-0.1587,0.2109,0.4444,0.4656,0.2680,-0.0864,-0.4937,-0.8462,-1.0675,-1.1284,-1.0427,-0.8486,-0.5879,-0.2936,0.0116,0.3087,0.5757,0.7868,0.9170,0.9490,0.8772,0.7068,0.4509,0.1289,-0.2296,-0.5799,-0.8620,-1.0131,-0.9920,-0.8054,-0.5229,-0.2640,-0.1556,-0.2758,-0.6064,-1.0241,-1.3410,-1.3819,-1.0677,-0.4636,0.2355,0.7798,0.9711,0.7500,0.2239,-0.3808,-0.8206,-0.9422,-0.7457,-0.3716,-0.0221,0.1440,0.0876,-0.0988,-0.2505,-0.2251,0.0172,0.3917,0.7358,0.8988,0.8246,0.5825,0.3273,0.2118,0.2982,0.5195,0.7125,0.7082,0.4320,-0.0420,-0.5137,-0.7479,-0.5909,-0.0521,0.6907,1.3667,1.7315,1.6731,1.2533,0.6679,0.1495,-0.1381,-0.1614,-0.0105,0.1655,0.2405,0.1686,-0.0128,-0.2249,-0.4064,-0.5498,-0.6944,-0.8828,-1.1104,-1.3033,-1.3433,-1.1297,-0.6459,0.0102,0.6522,1.0796,1.1652,0.9110,0.4426,-0.0535,-0.4191,-0.5925,-0.6217,-0.6185,-0.6802,-0.8260,-0.9827,-1.0299,-0.8790,-0.5398,-0.1364,0.1434,0.1412,-0.1838,-0.7195,-1.2409,-1.5093,-1.3846,-0.8945,-0.2267,0.3551,0.6309,0.5233,0.1296,-0.3284,-0.6095,-0.5639,-0.1989,0.3306,0.7965,1.0013,0.8617,0.4382,-0.0997,-0.5494,-0.7581,-0.6750,-0.3577,0.0651,0.4502,0.6913,0.7474,0.6411,0.4365,0.2092,0.0205,-0.0981,-0.1495,-0.1656,-0.1958,-0.2892,-0.4748,-0.7444,-1.0455,-1.2910,-1.3853,-1.2614,-0.9121,-0.4032,0.1420,0.5813,0.8036,0.7672,0.5128,0.1449,-0.2086,-0.4407,-0.4955,-0.3739,-0.1190,0.2096,0.5559,0.8754,1.1319,1.2914,1.3227,1.2081,0.9583,0.6205,0.2696,-0.0172,-0.1931,-0.2637,-0.2855,-0.3355,-0.4676,-0.6750,-0.8831,-0.9783,-0.8648,-0.5210,-0.0270,0.4557,0.7469,0.7285,0.4042,-0.0907,-0.5394,-0.7331,-0.5630,-0.0721,0.5577,1.0792,1.2831,1.0867,0.5685,-0.0657,-0.5686,-0.7534,-0.5656,-0.0970,0.4628,0.9114,1.1184,1.0706,0.8625,0.6400,0.5268,0.5683,0.7194,0.8776,0.9439};
	double excite;	// excitation command, rad
		
	if (i<1798){ excite = OMS4_ch1[i] * amp;}
	else {excite = 0.0;}
	return excite;
}

double playback_OMS4_2(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS4_ch2[1799] = {0.9439,0.8770,0.7174,0.5657,0.5251,0.6399,0.8618,1.0643,1.1006,0.8786,0.4176,-0.1447,-0.6022,-0.7664,-0.5538,-0.0308,0.6049,1.1021,1.2601,1.0143,0.4642,-0.1688,-0.6354,-0.7639,-0.5294,-0.0592,0.4273,0.7154,0.6840,0.3494,-0.1529,-0.6360,-0.9432,-1.0090,-0.8710,-0.6359,-0.4181,-0.2850,-0.2323,-0.1983,-0.1056,0.0944,0.3960,0.7421,1.0513,1.2517,1.3044,1.2093,0.9929,0.6929,0.3480,-0.0023,-0.3110,-0.5230,-0.5850,-0.4679,-0.1896,0.1756,0.5101,0.6893,0.6273,0.3122,-0.1850,-0.7333,-1.1879,-1.4401,-1.4502,-1.2535,-0.9374,-0.6045,-0.3361,-0.1700,-0.0980,-0.0787,-0.0584,0.0080,0.1417,0.3309,0.5314,0.6758,0.6941,0.5408,0.2222,-0.1905,-0.5723,-0.7836,-0.7259,-0.3915,0.1171,0.6158,0.9078,0.8681,0.5045,-0.0369,-0.5297,-0.7667,-0.6573,-0.2737,0.1769,0.4466,0.3641,-0.0812,-0.7288,-1.3181,-1.6080,-1.4875,-1.0246,-0.4311,0.0387,0.2050,0.0377,-0.3441,-0.7426,-0.9840,-0.9974,-0.8327,-0.6133,-0.4531,-0.3877,-0.3582,-0.2546,0.0062,0.4140,0.8509,1.1384,1.1238,0.7604,0.1376,-0.5533,-1.1027,-1.3705,-1.3364,-1.0888,-0.7649,-0.4771,-0.2668,-0.1065,0.0558,0.2434,0.4245,0.5299,0.5051,0.3624,0.1964,0.1467,0.3221,0.7279,1.2388,1.6407,1.7268,1.4014,0.7391,-0.0364,-0.6457,-0.8788,-0.6872,-0.2007,0.3411,0.7059,0.7760,0.5927,0.3175,0.1352,0.1512,0.3388,0.5606,0.6516,0.5148,0.1775,-0.2235,-0.5170,-0.5925,-0.4612,-0.2489,-0.1244,-0.2023,-0.4731,-0.8008,-0.9907,-0.8931,-0.4905,0.0805,0.5840,0.7918,0.5901,0.0341,-0.6742,-1.2753,-1.5633,-1.4685,-1.0754,-0.5738,-0.1689,0.0044,-0.0730,-0.3137,-0.5752,-0.7261,-0.6942,-0.4814,-0.1463,0.2295,0.5725,0.8342,0.9911,1.0368,0.9741,0.8122,0.5689,0.2713,-0.0479,-0.3564,-0.6288,-0.8473,-0.9962,-1.0565,-1.0049,-0.8240,-0.5180,-0.1280,0.2670,0.5671,0.6854,0.5827,0.2895,-0.0993,-0.4553,-0.6615,-0.6529,-0.4351,-0.0750,0.3293,0.6850,0.9311,1.0461,1.0388,0.9315,0.7458,0.4984,0.2052,-0.1123,-0.4249,-0.6992,-0.9046,-1.0186,-1.0279,-0.9264,-0.7155,-0.4088,-0.0416,0.3241,0.6077,0.7346,0.6707,0.4510,0.1813,0.0064,0.0492,0.3484,0.8246,1.2989,1.5618,1.4666,1.0035,0.3172,-0.3464,-0.7428,-0.7357,-0.3565,0.2126,0.7247,0.9826,0.9246,0.6418,0.3196,0.1353,0.1662,0.3545,0.5470,0.5845,0.3930,0.0261,-0.3646,-0.6131,-0.6311,-0.4563,-0.2303,-0.1169,-0.2053,-0.4543,-0.7078,-0.7789,-0.5566,-0.0795,0.4672,0.8318,0.8168,0.3779,-0.3479,-1.1010,-1.6151,-1.7329,-1.4678,-0.9825,-0.5011,-0.2029,-0.1485,-0.2739,-0.4443,-0.5350,-0.4911,-0.3387,-0.1471,0.0282,0.1837,0.3627,0.6120,0.9280,1.2309,1.3877,1.2761,0.8569,0.2131,-0.4710,-0.9832,-1.1749,-1.0245,-0.6395,-0.1968,0.1459,0.3224,0.3750,0.4102,0.5212,0.7215,0.9304,1.0186,0.8904,0.5538,0.1381,-0.1586,-0.1656,0.1666,0.7278,1.2880,1.5990,1.5114,1.0477,0.3949,-0.1803,-0.4544,-0.3481,0.0409,0.4891,0.7547,0.6894,0.3040,-0.2426,-0.7205,-0.9324,-0.7981,-0.3807,0.1488,0.5894,0.7914,0.7071,0.3942,-0.0207,-0.3992,-0.6400,-0.7045,-0.6152,-0.4336,-0.2314,-0.0664,0.0330,0.0719,0.0851,0.1243,0.2398,0.4588,0.7671,1.1038,1.3731,1.4748,1.3436,0.9804,0.4621,-0.0791,-0.4987,-0.6912,-0.6259,-0.3549,0.0111,0.3455,0.5490,0.5754,0.4327,0.1651,-0.1708,-0.5237,-0.8509,-1.1140,-1.2741,-1.2973,-1.1685,-0.9064,-0.5684,-0.2351,0.0201,0.1635,0.2180,0.2515,0.3396,0.5190,0.7579,0.9598,1.0062,0.8182,0.4083,-0.1078,-0.5483,-0.7419,-0.6067,-0.1967,0.3112,0.6872,0.7474,0.4365,-0.1418,-0.7654,-1.1852,-1.2314,-0.8858,-0.2886,0.3212,0.7067,0.7294,0.3999,-0.1369,-0.6719,-1.0236,-1.1111,-0.9751,-0.7441,-0.5639,-0.5268,-0.6334,-0.8033,-0.9265,-0.9265,-0.8033,-0.6334,-0.5268,-0.5639,-0.7441,-0.9751,-1.1111,-1.0236,-0.6719,-0.1369,0.3999,0.7294,0.7067,0.3212,-0.2886,-0.8858,-1.2314,-1.1852,-0.7654,-0.1418,0.4365,0.7474,0.6872,0.3112,-0.1967,-0.6067,-0.7419,-0.5483,-0.1078,0.4083,0.8182,1.0062,0.9598,0.7579,0.5190,0.3396,0.2515,0.2180,0.1635,0.0201,-0.2351,-0.5684,-0.9064,-1.1685,-1.2973,-1.2741,-1.1140,-0.8509,-0.5237,-0.1708,0.1651,0.4327,0.5754,0.5490,0.3455,0.0111,-0.3549,-0.6259,-0.6912,-0.4987,-0.0791,0.4621,0.9804,1.3436,1.4748,1.3731,1.1038,0.7671,0.4588,0.2398,0.1243,0.0851,0.0719,0.0330,-0.0664,-0.2314,-0.4336,-0.6152,-0.7045,-0.6400,-0.3992,-0.0207,0.3942,0.7071,0.7914,0.5894,0.1488,-0.3807,-0.7981,-0.9324,-0.7205,-0.2426,0.3040,0.6894,0.7547,0.4891,0.0409,-0.3481,-0.4544,-0.1803,0.3949,1.0477,1.5114,1.5990,1.2880,0.7278,0.1666,-0.1656,-0.1586,0.1381,0.5538,0.8904,1.0186,0.9304,0.7215,0.5212,0.4102,0.3750,0.3224,0.1459,-0.1968,-0.6395,-1.0245,-1.1749,-0.9832,-0.4710,0.2131,0.8569,1.2761,1.3877,1.2309,0.9280,0.6120,0.3627,0.1837,0.0282,-0.1471,-0.3387,-0.4911,-0.5350,-0.4443,-0.2739,-0.1485,-0.2029,-0.5011,-0.9825,-1.4678,-1.7329,-1.6151,-1.1010,-0.3479,0.3779,0.8168,0.8318,0.4672,-0.0795,-0.5566,-0.7789,-0.7078,-0.4543,-0.2053,-0.1169,-0.2303,-0.4563,-0.6311,-0.6131,-0.3646,0.0261,0.3930,0.5845,0.5470,0.3545,0.1662,0.1353,0.3196,0.6418,0.9246,0.9826,0.7247,0.2126,-0.3565,-0.7357,-0.7428,-0.3464,0.3172,1.0035,1.4666,1.5618,1.2989,0.8246,0.3484,0.0492,0.0064,0.1813,0.4510,0.6707,0.7346,0.6077,0.3241,-0.0416,-0.4088,-0.7155,-0.9264,-1.0279,-1.0186,-0.9046,-0.6992,-0.4249,-0.1123,0.2052,0.4984,0.7458,0.9315,1.0388,1.0461,0.9311,0.6850,0.3293,-0.0750,-0.4351,-0.6529,-0.6615,-0.4553,-0.0993,0.2895,0.5827,0.6854,0.5671,0.2670,-0.1280,-0.5180,-0.8240,-1.0049,-1.0565,-0.9962,-0.8473,-0.6288,-0.3564,-0.0479,0.2713,0.5689,0.8122,0.9741,1.0368,0.9911,0.8342,0.5725,0.2295,-0.1463,-0.4814,-0.6942,-0.7261,-0.5752,-0.3137,-0.0730,0.0044,-0.1689,-0.5738,-1.0754,-1.4685,-1.5633,-1.2753,-0.6742,0.0341,0.5901,0.7918,0.5840,0.0805,-0.4905,-0.8931,-0.9907,-0.8008,-0.4731,-0.2023,-0.1244,-0.2489,-0.4612,-0.5925,-0.5170,-0.2235,0.1775,0.5148,0.6516,0.5606,0.3388,0.1512,0.1352,0.3175,0.5927,0.7760,0.7059,0.3411,-0.2007,-0.6872,-0.8788,-0.6457,-0.0364,0.7391,1.4014,1.7268,1.6407,1.2388,0.7279,0.3221,0.1467,0.1964,0.3624,0.5051,0.5299,0.4245,0.2434,0.0558,-0.1065,-0.2668,-0.4771,-0.7649,-1.0888,-1.3364,-1.3705,-1.1027,-0.5533,0.1376,0.7604,1.1238,1.1384,0.8509,0.4140,0.0062,-0.2546,-0.3582,-0.3877,-0.4531,-0.6133,-0.8327,-0.9974,-0.9840,-0.7426,-0.3441,0.0377,0.2050,0.0387,-0.4311,-1.0246,-1.4875,-1.6080,-1.3181,-0.7288,-0.0812,0.3641,0.4466,0.1769,-0.2737,-0.6573,-0.7667,-0.5297,-0.0369,0.5045,0.8681,0.9078,0.6158,0.1171,-0.3915,-0.7259,-0.7836,-0.5723,-0.1905,0.2222,0.5408,0.6941,0.6758,0.5314,0.3309,0.1417,0.0080,-0.0584,-0.0787,-0.0980,-0.1700,-0.3361,-0.6045,-0.9374,-1.2535,-1.4502,-1.4401,-1.1879,-0.7333,-0.1850,0.3122,0.6273,0.6893,0.5101,0.1756,-0.1896,-0.4679,-0.5850,-0.5230,-0.3110,-0.0023,0.3480,0.6929,0.9929,1.2093,1.3044,1.2517,1.0513,0.7421,0.3960,0.0944,-0.1056,-0.1983,-0.2323,-0.2850,-0.4181,-0.6359,-0.8710,-1.0090,-0.9432,-0.6360,-0.1529,0.3494,0.6840,0.7154,0.4273,-0.0592,-0.5294,-0.7639,-0.6354,-0.1688,0.4642,1.0143,1.2601,1.1021,0.6049,-0.0308,-0.5538,-0.7664,-0.6022,-0.1447,0.4176,0.8786,1.1006,1.0643,0.8618,0.6399,0.5251,0.5657,0.7174,0.8770,0.9439,0.8770,0.7174,0.5657,0.5251,0.6399,0.8618,1.0643,1.1006,0.8786,0.4176,-0.1447,-0.6022,-0.7664,-0.5538,-0.0308,0.6049,1.1021,1.2601,1.0143,0.4642,-0.1688,-0.6354,-0.7639,-0.5294,-0.0592,0.4273,0.7154,0.6840,0.3494,-0.1529,-0.6360,-0.9432,-1.0090,-0.8710,-0.6359,-0.4181,-0.2850,-0.2323,-0.1983,-0.1056,0.0944,0.3960,0.7421,1.0513,1.2517,1.3044,1.2093,0.9929,0.6929,0.3480,-0.0023,-0.3110,-0.5230,-0.5850,-0.4679,-0.1896,0.1756,0.5101,0.6893,0.6273,0.3122,-0.1850,-0.7333,-1.1879,-1.4401,-1.4502,-1.2535,-0.9374,-0.6045,-0.3361,-0.1700,-0.0980,-0.0787,-0.0584,0.0080,0.1417,0.3309,0.5314,0.6758,0.6941,0.5408,0.2222,-0.1905,-0.5723,-0.7836,-0.7259,-0.3915,0.1171,0.6158,0.9078,0.8681,0.5045,-0.0369,-0.5297,-0.7667,-0.6573,-0.2737,0.1769,0.4466,0.3641,-0.0812,-0.7288,-1.3181,-1.6080,-1.4875,-1.0246,-0.4311,0.0387,0.2050,0.0377,-0.3441,-0.7426,-0.9840,-0.9974,-0.8327,-0.6133,-0.4531,-0.3877,-0.3582,-0.2546,0.0062,0.4140,0.8509,1.1384,1.1238,0.7604,0.1376,-0.5533,-1.1027,-1.3705,-1.3364,-1.0888,-0.7649,-0.4771,-0.2668,-0.1065,0.0558,0.2434,0.4245,0.5299,0.5051,0.3624,0.1964,0.1467,0.3221,0.7279,1.2388,1.6407,1.7268,1.4014,0.7391,-0.0364,-0.6457,-0.8788,-0.6872,-0.2007,0.3411,0.7059,0.7760,0.5927,0.3175,0.1352,0.1512,0.3388,0.5606,0.6516,0.5148,0.1775,-0.2235,-0.5170,-0.5925,-0.4612,-0.2489,-0.1244,-0.2023,-0.4731,-0.8008,-0.9907,-0.8931,-0.4905,0.0805,0.5840,0.7918,0.5901,0.0341,-0.6742,-1.2753,-1.5633,-1.4685,-1.0754,-0.5738,-0.1689,0.0044,-0.0730,-0.3137,-0.5752,-0.7261,-0.6942,-0.4814,-0.1463,0.2295,0.5725,0.8342,0.9911,1.0368,0.9741,0.8122,0.5689,0.2713,-0.0479,-0.3564,-0.6288,-0.8473,-0.9962,-1.0565,-1.0049,-0.8240,-0.5180,-0.1280,0.2670,0.5671,0.6854,0.5827,0.2895,-0.0993,-0.4553,-0.6615,-0.6529,-0.4351,-0.0750,0.3293,0.6850,0.9311,1.0461,1.0388,0.9315,0.7458,0.4984,0.2052,-0.1123,-0.4249,-0.6992,-0.9046,-1.0186,-1.0279,-0.9264,-0.7155,-0.4088,-0.0416,0.3241,0.6077,0.7346,0.6707,0.4510,0.1813,0.0064,0.0492,0.3484,0.8246,1.2989,1.5618,1.4666,1.0035,0.3172,-0.3464,-0.7428,-0.7357,-0.3565,0.2126,0.7247,0.9826,0.9246,0.6418,0.3196,0.1353,0.1662,0.3545,0.5470,0.5845,0.3930,0.0261,-0.3646,-0.6131,-0.6311,-0.4563,-0.2303,-0.1169,-0.2053,-0.4543,-0.7078,-0.7789,-0.5566,-0.0795,0.4672,0.8318,0.8168,0.3779,-0.3479,-1.1010,-1.6151,-1.7329,-1.4678,-0.9825,-0.5011,-0.2029,-0.1485,-0.2739,-0.4443,-0.5350,-0.4911,-0.3387,-0.1471,0.0282,0.1837,0.3627,0.6120,0.9280,1.2309,1.3877,1.2761,0.8569,0.2131,-0.4710,-0.9832,-1.1749,-1.0245,-0.6395,-0.1968,0.1459,0.3224,0.3750,0.4102,0.5212,0.7215,0.9304,1.0186,0.8904,0.5538,0.1381,-0.1586,-0.1656,0.1666,0.7278,1.2880,1.5990,1.5114,1.0477,0.3949,-0.1803,-0.4544,-0.3481,0.0409,0.4891,0.7547,0.6894,0.3040,-0.2426,-0.7205,-0.9324,-0.7981,-0.3807,0.1488,0.5894,0.7914,0.7071,0.3942,-0.0207,-0.3992,-0.6400,-0.7045,-0.6152,-0.4336,-0.2314,-0.0664,0.0330,0.0719,0.0851,0.1243,0.2398,0.4588,0.7671,1.1038,1.3731,1.4748,1.3436,0.9804,0.4621,-0.0791,-0.4987,-0.6912,-0.6259,-0.3549,0.0111,0.3455,0.5490,0.5754,0.4327,0.1651,-0.1708,-0.5237,-0.8509,-1.1140,-1.2741,-1.2973,-1.1685,-0.9064,-0.5684,-0.2351,0.0201,0.1635,0.2180,0.2515,0.3396,0.5190,0.7579,0.9598,1.0062,0.8182,0.4083,-0.1078,-0.5483,-0.7419,-0.6067,-0.1967,0.3112,0.6872,0.7474,0.4365,-0.1418,-0.7654,-1.1852,-1.2314,-0.8858,-0.2886,0.3212,0.7067,0.7294,0.3999,-0.1369,-0.6719,-1.0236,-1.1111,-0.9751,-0.7441,-0.5639,-0.5268,-0.6334,-0.8033,-0.9265,-0.9265,-0.8033,-0.6334,-0.5268,-0.5639,-0.7441,-0.9751,-1.1111,-1.0236,-0.6719,-0.1369,0.3999,0.7294,0.7067,0.3212,-0.2886,-0.8858,-1.2314,-1.1852,-0.7654,-0.1418,0.4365,0.7474,0.6872,0.3112,-0.1967,-0.6067,-0.7419,-0.5483,-0.1078,0.4083,0.8182,1.0062,0.9598,0.7579,0.5190,0.3396,0.2515,0.2180,0.1635,0.0201,-0.2351,-0.5684,-0.9064,-1.1685,-1.2973,-1.2741,-1.1140,-0.8509,-0.5237,-0.1708,0.1651,0.4327,0.5754,0.5490,0.3455,0.0111,-0.3549,-0.6259,-0.6912,-0.4987,-0.0791,0.4621,0.9804,1.3436,1.4748,1.3731,1.1038,0.7671,0.4588,0.2398,0.1243,0.0851,0.0719,0.0330,-0.0664,-0.2314,-0.4336,-0.6152,-0.7045,-0.6400,-0.3992,-0.0207,0.3942,0.7071,0.7914,0.5894,0.1488,-0.3807,-0.7981,-0.9324,-0.7205,-0.2426,0.3040,0.6894,0.7547,0.4891,0.0409,-0.3481,-0.4544,-0.1803,0.3949,1.0477,1.5114,1.5990,1.2880,0.7278,0.1666,-0.1656,-0.1586,0.1381,0.5538,0.8904,1.0186,0.9304,0.7215,0.5212,0.4102,0.3750,0.3224,0.1459,-0.1968,-0.6395,-1.0245,-1.1749,-0.9832,-0.4710,0.2131,0.8569,1.2761,1.3877,1.2309,0.9280,0.6120,0.3627,0.1837,0.0282,-0.1471,-0.3387,-0.4911,-0.5350,-0.4443,-0.2739,-0.1485,-0.2029,-0.5011,-0.9825,-1.4678,-1.7329,-1.6151,-1.1010,-0.3479,0.3779,0.8168,0.8318,0.4672,-0.0795,-0.5566,-0.7789,-0.7078,-0.4543,-0.2053,-0.1169,-0.2303,-0.4563,-0.6311,-0.6131,-0.3646,0.0261,0.3930,0.5845,0.5470,0.3545,0.1662,0.1353,0.3196,0.6418,0.9246,0.9826,0.7247,0.2126,-0.3565,-0.7357,-0.7428,-0.3464,0.3172,1.0035,1.4666,1.5618,1.2989,0.8246,0.3484,0.0492,0.0064,0.1813,0.4510,0.6707,0.7346,0.6077,0.3241,-0.0416,-0.4088,-0.7155,-0.9264,-1.0279,-1.0186,-0.9046,-0.6992,-0.4249,-0.1123,0.2052,0.4984,0.7458,0.9315,1.0388,1.0461,0.9311,0.6850,0.3293,-0.0750,-0.4351,-0.6529,-0.6615,-0.4553,-0.0993,0.2895,0.5827,0.6854,0.5671,0.2670,-0.1280,-0.5180,-0.8240,-1.0049,-1.0565,-0.9962,-0.8473,-0.6288,-0.3564,-0.0479,0.2713,0.5689,0.8122,0.9741,1.0368,0.9911,0.8342,0.5725,0.2295,-0.1463,-0.4814,-0.6942,-0.7261,-0.5752,-0.3137,-0.0730,0.0044,-0.1689,-0.5738,-1.0754,-1.4685,-1.5633,-1.2753,-0.6742,0.0341,0.5901,0.7918,0.5840,0.0805,-0.4905,-0.8931,-0.9907,-0.8008,-0.4731,-0.2023,-0.1244,-0.2489,-0.4612,-0.5925,-0.5170,-0.2235,0.1775,0.5148,0.6516,0.5606,0.3388,0.1512,0.1352,0.3175,0.5927,0.7760,0.7059,0.3411,-0.2007,-0.6872,-0.8788,-0.6457,-0.0364,0.7391,1.4014,1.7268,1.6407,1.2388,0.7279,0.3221,0.1467,0.1964,0.3624,0.5051,0.5299,0.4245,0.2434,0.0558,-0.1065,-0.2668,-0.4771,-0.7649,-1.0888,-1.3364,-1.3705,-1.1027,-0.5533,0.1376,0.7604,1.1238,1.1384,0.8509,0.4140,0.0062,-0.2546,-0.3582,-0.3877,-0.4531,-0.6133,-0.8327,-0.9974,-0.9840,-0.7426,-0.3441,0.0377,0.2050,0.0387,-0.4311,-1.0246,-1.4875,-1.6080,-1.3181,-0.7288,-0.0812,0.3641,0.4466,0.1769,-0.2737,-0.6573,-0.7667,-0.5297,-0.0369,0.5045,0.8681,0.9078,0.6158,0.1171,-0.3915,-0.7259,-0.7836,-0.5723,-0.1905,0.2222,0.5408,0.6941,0.6758,0.5314,0.3309,0.1417,0.0080,-0.0584,-0.0787,-0.0980,-0.1700,-0.3361,-0.6045,-0.9374,-1.2535,-1.4502,-1.4401,-1.1879,-0.7333,-0.1850,0.3122,0.6273,0.6893,0.5101,0.1756,-0.1896,-0.4679,-0.5850,-0.5230,-0.3110,-0.0023,0.3480,0.6929,0.9929,1.2093,1.3044,1.2517,1.0513,0.7421,0.3960,0.0944,-0.1056,-0.1983,-0.2323,-0.2850,-0.4181,-0.6359,-0.8710,-1.0090,-0.9432,-0.6360,-0.1529,0.3494,0.6840,0.7154,0.4273,-0.0592,-0.5294,-0.7639,-0.6354,-0.1688,0.4642,1.0143,1.2601,1.1021,0.6049,-0.0308,-0.5538,-0.7664,-0.6022,-0.1447,0.4176,0.8786,1.1006,1.0643,0.8618,0.6399,0.5251,0.5657,0.7174,0.8770,0.9439};
	double excite;	// excitation command, rad
		
	if (i<1798){ excite = OMS4_ch2[i] * amp;}
	else {excite = 0.0;}
	return excite;
}


double playback_OMS4_3(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS4_ch3[1799] = {1.0787,0.9722,0.7169,0.4694,0.3886,0.5414,0.8558,1.1486,1.2166,0.9454,0.3803,-0.2811,-0.7722,-0.8805,-0.5492,0.0904,0.7737,1.2183,1.2470,0.8614,0.2346,-0.3713,-0.7222,-0.7088,-0.3823,0.0815,0.4682,0.6175,0.4817,0.1289,-0.3018,-0.6678,-0.8776,-0.9137,-0.8188,-0.6601,-0.4936,-0.3441,-0.2060,-0.0590,0.1147,0.3201,0.5481,0.7797,0.9895,1.1466,1.2151,1.1590,0.9551,0.6095,0.1701,-0.2756,-0.6209,-0.7749,-0.6975,-0.4193,-0.0362,0.3216,0.5333,0.5266,0.2976,-0.0947,-0.5532,-0.9754,-1.2799,-1.4199,-1.3854,-1.1971,-0.9000,-0.5557,-0.2333,0.0060,0.1280,0.1405,0.0955,0.0703,0.1323,0.3005,0.5252,0.6996,0.7059,0.4765,0.0409,-0.4672,-0.8554,-0.9537,-0.6963,-0.1640,0.4387,0.8653,0.9353,0.6172,0.0466,-0.5323,-0.8771,-0.8584,-0.5196,-0.0555,0.2796,0.2928,-0.0571,-0.6404,-1.2180,-1.5519,-1.5129,-1.1341,-0.5878,-0.1008,0.1492,0.1056,-0.1575,-0.4863,-0.7287,-0.8034,-0.7220,-0.5611,-0.4036,-0.2858,-0.1810,-0.0258,0.2276,0.5651,0.8989,1.0999,1.0574,0.7365,0.2022,-0.4025,-0.9124,-1.2043,-1.2371,-1.0522,-0.7399,-0.3918,-0.0672,0.2138,0.4513,0.6401,0.7570,0.7723,0.6785,0.5150,0.3690,0.3432,0.5043,0.8356,1.2260,1.5052,1.5157,1.1891,0.5880,-0.1082,-0.6727,-0.9258,-0.8093,-0.4081,0.0925,0.4914,0.6590,0.5853,0.3677,0.1498,0.0427,0.0712,0.1695,0.2259,0.1508,-0.0710,-0.3706,-0.6323,-0.7578,-0.7199,-0.5772,-0.4407,-0.4097,-0.5130,-0.6867,-0.8044,-0.7450,-0.4647,-0.0338,0.3827,0.5947,0.4765,0.0315,-0.5985,-1.1865,-1.5143,-1.4632,-1.0632,-0.4766,0.0725,0.3940,0.4072,0.1669,-0.1699,-0.4170,-0.4393,-0.2034,0.2175,0.6840,1.0519,1.2283,1.1964,1.0058,0.7368,0.4592,0.2063,-0.0270,-0.2639,-0.5175,-0.7711,-0.9762,-1.0700,-1.0031,-0.7636,-0.3879,0.0475,0.4489,0.7326,0.8474,0.7852,0.5787,0.2898,-0.0070,-0.2392,-0.3498,-0.3066,-0.1093,0.2078,0.5791,0.9199,1.1462,1.1973,1.0551,0.7508,0.3547,-0.0467,-0.3806,-0.6093,-0.7359,-0.7910,-0.8063,-0.7912,-0.7227,-0.5591,-0.2688,0.1374,0.5913,0.9804,1.1893,1.1512,0.8876,0.5116,0.1896,0.0732,0.2299,0.6052,1.0364,1.3176,1.2881,0.9065,0.2764,-0.3912,-0.8635,-0.9827,-0.7302,-0.2312,0.3035,0.6705,0.7575,0.5819,0.2675,-0.0254,-0.1806,-0.1771,-0.0880,-0.0308,-0.0978,-0.3034,-0.5773,-0.8038,-0.8866,-0.8017,-0.6100,-0.4227,-0.3374,-0.3816,-0.4945,-0.5593,-0.4704,-0.2008,0.1695,0.4799,0.5627,0.3270,-0.1874,-0.8159,-1.3339,-1.5504,-1.3885,-0.9147,-0.3046,0.2353,0.5545,0.6115,0.4751,0.2775,0.1467,0.1539,0.2967,0.5195,0.7542,0.9531,1.0990,1.1894,1.2129,1.1368,0.9190,0.5400,0.0352,-0.4954,-0.9116,-1.0853,-0.9567,-0.5646,-0.0341,0.4745,0.8321,0.9892,0.9827,0.9007,0.8244,0.7823,0.7409,0.6367,0.4308,0.1515,-0.1031,-0.2087,-0.0843,0.2497,0.6610,0.9540,0.9587,0.6172,0.0233,-0.6089,-1.0376,-1.1040,-0.8082,-0.3122,0.1339,0.3083,0.1224,-0.3372,-0.8494,-1.1620,-1.1099,-0.6915,-0.0693,0.5051,0.8029,0.7165,0.3000,-0.2640,-0.7497,-0.9845,-0.9134,-0.6057,-0.2075,0.1310,0.3189,0.3519,0.2964,0.2452,0.2695,0.3885,0.5679,0.7398,0.8326,0.7956,0.6105,0.2918,-0.1187,-0.5591,-0.9548,-1.2293,-1.3210,-1.2035,-0.9025,-0.4980,-0.1079,0.1476,0.1856,-0.0087,-0.3765,-0.8056,-1.1702,-1.3723,-1.3696,-1.1785,-0.8582,-0.4829,-0.1175,0.1945,0.4316,0.5885,0.6693,0.6861,0.6573,0.6050,0.5461,0.4810,0.3887,0.2343,-0.0096,-0.3361,-0.6876,-0.9644,-1.0613,-0.9193,-0.5677,-0.1316,0.2079,0.2880,0.0433,-0.4512,-0.9978,-1.3544,-1.3422,-0.9321,-0.2696,0.3812,0.7493,0.6772,0.1923,-0.5047,-1.1301,-1.4434,-1.3511,-0.9389,-0.4198,-0.0254,0.1049,-0.0184,-0.2553,-0.4211,-0.3893,-0.1574,0.1574,0.3893,0.4211,0.2553,0.0184,-0.1049,0.0254,0.4198,0.9389,1.3511,1.4434,1.1301,0.5047,-0.1923,-0.6772,-0.7493,-0.3812,0.2696,0.9321,1.3422,1.3544,0.9978,0.4512,-0.0433,-0.2880,-0.2079,0.1316,0.5677,0.9193,1.0613,0.9644,0.6876,0.3361,0.0096,-0.2343,-0.3887,-0.4810,-0.5461,-0.6050,-0.6573,-0.6861,-0.6693,-0.5885,-0.4316,-0.1945,0.1175,0.4829,0.8582,1.1785,1.3696,1.3723,1.1702,0.8056,0.3765,0.0087,-0.1856,-0.1476,0.1079,0.4980,0.9025,1.2035,1.3210,1.2293,0.9548,0.5591,0.1187,-0.2918,-0.6105,-0.7956,-0.8326,-0.7398,-0.5679,-0.3885,-0.2695,-0.2452,-0.2964,-0.3519,-0.3189,-0.1310,0.2075,0.6057,0.9134,0.9845,0.7497,0.2640,-0.3000,-0.7165,-0.8029,-0.5051,0.0693,0.6915,1.1099,1.1620,0.8494,0.3372,-0.1224,-0.3083,-0.1339,0.3122,0.8082,1.1040,1.0376,0.6089,-0.0233,-0.6172,-0.9587,-0.9540,-0.6610,-0.2497,0.0843,0.2087,0.1031,-0.1515,-0.4308,-0.6367,-0.7409,-0.7823,-0.8244,-0.9007,-0.9827,-0.9892,-0.8321,-0.4745,0.0341,0.5646,0.9567,1.0853,0.9116,0.4954,-0.0352,-0.5400,-0.9190,-1.1368,-1.2129,-1.1894,-1.0990,-0.9531,-0.7542,-0.5195,-0.2967,-0.1539,-0.1467,-0.2775,-0.4751,-0.6115,-0.5545,-0.2353,0.3046,0.9147,1.3885,1.5504,1.3339,0.8159,0.1874,-0.3270,-0.5627,-0.4799,-0.1695,0.2008,0.4704,0.5593,0.4945,0.3816,0.3374,0.4227,0.6100,0.8017,0.8866,0.8038,0.5773,0.3034,0.0978,0.0308,0.0880,0.1771,0.1806,0.0254,-0.2675,-0.5819,-0.7575,-0.6705,-0.3035,0.2312,0.7302,0.9827,0.8635,0.3912,-0.2764,-0.9065,-1.2881,-1.3176,-1.0364,-0.6052,-0.2299,-0.0732,-0.1896,-0.5116,-0.8876,-1.1512,-1.1893,-0.9804,-0.5913,-0.1374,0.2688,0.5591,0.7227,0.7912,0.8063,0.7910,0.7359,0.6093,0.3806,0.0467,-0.3547,-0.7508,-1.0551,-1.1973,-1.1462,-0.9199,-0.5791,-0.2078,0.1093,0.3066,0.3498,0.2392,0.0070,-0.2898,-0.5787,-0.7852,-0.8474,-0.7326,-0.4489,-0.0475,0.3879,0.7636,1.0031,1.0700,0.9762,0.7711,0.5175,0.2639,0.0270,-0.2063,-0.4592,-0.7368,-1.0058,-1.1964,-1.2283,-1.0519,-0.6840,-0.2175,0.2034,0.4393,0.4170,0.1699,-0.1669,-0.4072,-0.3940,-0.0725,0.4766,1.0632,1.4632,1.5143,1.1865,0.5985,-0.0315,-0.4765,-0.5947,-0.3827,0.0338,0.4647,0.7450,0.8044,0.6867,0.5130,0.4097,0.4407,0.5772,0.7199,0.7578,0.6323,0.3706,0.0710,-0.1508,-0.2259,-0.1695,-0.0712,-0.0427,-0.1498,-0.3677,-0.5853,-0.6590,-0.4914,-0.0925,0.4081,0.8093,0.9258,0.6727,0.1082,-0.5880,-1.1891,-1.5157,-1.5052,-1.2260,-0.8356,-0.5043,-0.3432,-0.3690,-0.5150,-0.6785,-0.7723,-0.7570,-0.6401,-0.4513,-0.2138,0.0672,0.3918,0.7399,1.0522,1.2371,1.2043,0.9124,0.4025,-0.2022,-0.7365,-1.0574,-1.0999,-0.8989,-0.5651,-0.2276,0.0258,0.1810,0.2858,0.4036,0.5611,0.7220,0.8034,0.7287,0.4863,0.1575,-0.1056,-0.1492,0.1008,0.5878,1.1341,1.5129,1.5519,1.2180,0.6404,0.0571,-0.2928,-0.2796,0.0555,0.5196,0.8584,0.8771,0.5323,-0.0466,-0.6172,-0.9353,-0.8653,-0.4387,0.1640,0.6963,0.9537,0.8554,0.4672,-0.0409,-0.4765,-0.7059,-0.6996,-0.5252,-0.3005,-0.1323,-0.0703,-0.0955,-0.1405,-0.1280,-0.0060,0.2333,0.5557,0.9000,1.1971,1.3854,1.4199,1.2799,0.9754,0.5532,0.0947,-0.2976,-0.5266,-0.5333,-0.3216,0.0362,0.4193,0.6975,0.7749,0.6209,0.2756,-0.1701,-0.6095,-0.9551,-1.1590,-1.2151,-1.1466,-0.9895,-0.7797,-0.5481,-0.3201,-0.1147,0.0590,0.2060,0.3441,0.4936,0.6601,0.8188,0.9137,0.8776,0.6678,0.3018,-0.1289,-0.4817,-0.6175,-0.4682,-0.0815,0.3823,0.7088,0.7222,0.3713,-0.2346,-0.8614,-1.2470,-1.2183,-0.7737,-0.0904,0.5492,0.8805,0.7722,0.2811,-0.3803,-0.9454,-1.2166,-1.1486,-0.8558,-0.5414,-0.3886,-0.4694,-0.7169,-0.9722,-1.0787,-0.9722,-0.7169,-0.4694,-0.3886,-0.5414,-0.8558,-1.1486,-1.2166,-0.9454,-0.3803,0.2811,0.7722,0.8805,0.5492,-0.0904,-0.7737,-1.2183,-1.2470,-0.8614,-0.2346,0.3713,0.7222,0.7088,0.3823,-0.0815,-0.4682,-0.6175,-0.4817,-0.1289,0.3018,0.6678,0.8776,0.9137,0.8188,0.6601,0.4936,0.3441,0.2060,0.0590,-0.1147,-0.3201,-0.5481,-0.7797,-0.9895,-1.1466,-1.2151,-1.1590,-0.9551,-0.6095,-0.1701,0.2756,0.6209,0.7749,0.6975,0.4193,0.0362,-0.3216,-0.5333,-0.5266,-0.2976,0.0947,0.5532,0.9754,1.2799,1.4199,1.3854,1.1971,0.9000,0.5557,0.2333,-0.0060,-0.1280,-0.1405,-0.0955,-0.0703,-0.1323,-0.3005,-0.5252,-0.6996,-0.7059,-0.4765,-0.0409,0.4672,0.8554,0.9537,0.6963,0.1640,-0.4387,-0.8653,-0.9353,-0.6172,-0.0466,0.5323,0.8771,0.8584,0.5196,0.0555,-0.2796,-0.2928,0.0571,0.6404,1.2180,1.5519,1.5129,1.1341,0.5878,0.1008,-0.1492,-0.1056,0.1575,0.4863,0.7287,0.8034,0.7220,0.5611,0.4036,0.2858,0.1810,0.0258,-0.2276,-0.5651,-0.8989,-1.0999,-1.0574,-0.7365,-0.2022,0.4025,0.9124,1.2043,1.2371,1.0522,0.7399,0.3918,0.0672,-0.2138,-0.4513,-0.6401,-0.7570,-0.7723,-0.6785,-0.5150,-0.3690,-0.3432,-0.5043,-0.8356,-1.2260,-1.5052,-1.5157,-1.1891,-0.5880,0.1082,0.6727,0.9258,0.8093,0.4081,-0.0925,-0.4914,-0.6590,-0.5853,-0.3677,-0.1498,-0.0427,-0.0712,-0.1695,-0.2259,-0.1508,0.0710,0.3706,0.6323,0.7578,0.7199,0.5772,0.4407,0.4097,0.5130,0.6867,0.8044,0.7450,0.4647,0.0338,-0.3827,-0.5947,-0.4765,-0.0315,0.5985,1.1865,1.5143,1.4632,1.0632,0.4766,-0.0725,-0.3940,-0.4072,-0.1669,0.1699,0.4170,0.4393,0.2034,-0.2175,-0.6840,-1.0519,-1.2283,-1.1964,-1.0058,-0.7368,-0.4592,-0.2063,0.0270,0.2639,0.5175,0.7711,0.9762,1.0700,1.0031,0.7636,0.3879,-0.0475,-0.4489,-0.7326,-0.8474,-0.7852,-0.5787,-0.2898,0.0070,0.2392,0.3498,0.3066,0.1093,-0.2078,-0.5791,-0.9199,-1.1462,-1.1973,-1.0551,-0.7508,-0.3547,0.0467,0.3806,0.6093,0.7359,0.7910,0.8063,0.7912,0.7227,0.5591,0.2688,-0.1374,-0.5913,-0.9804,-1.1893,-1.1512,-0.8876,-0.5116,-0.1896,-0.0732,-0.2299,-0.6052,-1.0364,-1.3176,-1.2881,-0.9065,-0.2764,0.3912,0.8635,0.9827,0.7302,0.2312,-0.3035,-0.6705,-0.7575,-0.5819,-0.2675,0.0254,0.1806,0.1771,0.0880,0.0308,0.0978,0.3034,0.5773,0.8038,0.8866,0.8017,0.6100,0.4227,0.3374,0.3816,0.4945,0.5593,0.4704,0.2008,-0.1695,-0.4799,-0.5627,-0.3270,0.1874,0.8159,1.3339,1.5504,1.3885,0.9147,0.3046,-0.2353,-0.5545,-0.6115,-0.4751,-0.2775,-0.1467,-0.1539,-0.2967,-0.5195,-0.7542,-0.9531,-1.0990,-1.1894,-1.2129,-1.1368,-0.9190,-0.5400,-0.0352,0.4954,0.9116,1.0853,0.9567,0.5646,0.0341,-0.4745,-0.8321,-0.9892,-0.9827,-0.9007,-0.8244,-0.7823,-0.7409,-0.6367,-0.4308,-0.1515,0.1031,0.2087,0.0843,-0.2497,-0.6610,-0.9540,-0.9587,-0.6172,-0.0233,0.6089,1.0376,1.1040,0.8082,0.3122,-0.1339,-0.3083,-0.1224,0.3372,0.8494,1.1620,1.1099,0.6915,0.0693,-0.5051,-0.8029,-0.7165,-0.3000,0.2640,0.7497,0.9845,0.9134,0.6057,0.2075,-0.1310,-0.3189,-0.3519,-0.2964,-0.2452,-0.2695,-0.3885,-0.5679,-0.7398,-0.8326,-0.7956,-0.6105,-0.2918,0.1187,0.5591,0.9548,1.2293,1.3210,1.2035,0.9025,0.4980,0.1079,-0.1476,-0.1856,0.0087,0.3765,0.8056,1.1702,1.3723,1.3696,1.1785,0.8582,0.4829,0.1175,-0.1945,-0.4316,-0.5885,-0.6693,-0.6861,-0.6573,-0.6050,-0.5461,-0.4810,-0.3887,-0.2343,0.0096,0.3361,0.6876,0.9644,1.0613,0.9193,0.5677,0.1316,-0.2079,-0.2880,-0.0433,0.4512,0.9978,1.3544,1.3422,0.9321,0.2696,-0.3812,-0.7493,-0.6772,-0.1923,0.5047,1.1301,1.4434,1.3511,0.9389,0.4198,0.0254,-0.1049,0.0184,0.2553,0.4211,0.3893,0.1574,-0.1574,-0.3893,-0.4211,-0.2553,-0.0184,0.1049,-0.0254,-0.4198,-0.9389,-1.3511,-1.4434,-1.1301,-0.5047,0.1923,0.6772,0.7493,0.3812,-0.2696,-0.9321,-1.3422,-1.3544,-0.9978,-0.4512,0.0433,0.2880,0.2079,-0.1316,-0.5677,-0.9193,-1.0613,-0.9644,-0.6876,-0.3361,-0.0096,0.2343,0.3887,0.4810,0.5461,0.6050,0.6573,0.6861,0.6693,0.5885,0.4316,0.1945,-0.1175,-0.4829,-0.8582,-1.1785,-1.3696,-1.3723,-1.1702,-0.8056,-0.3765,-0.0087,0.1856,0.1476,-0.1079,-0.4980,-0.9025,-1.2035,-1.3210,-1.2293,-0.9548,-0.5591,-0.1187,0.2918,0.6105,0.7956,0.8326,0.7398,0.5679,0.3885,0.2695,0.2452,0.2964,0.3519,0.3189,0.1310,-0.2075,-0.6057,-0.9134,-0.9845,-0.7497,-0.2640,0.3000,0.7165,0.8029,0.5051,-0.0693,-0.6915,-1.1099,-1.1620,-0.8494,-0.3372,0.1224,0.3083,0.1339,-0.3122,-0.8082,-1.1040,-1.0376,-0.6089,0.0233,0.6172,0.9587,0.9540,0.6610,0.2497,-0.0843,-0.2087,-0.1031,0.1515,0.4308,0.6367,0.7409,0.7823,0.8244,0.9007,0.9827,0.9892,0.8321,0.4745,-0.0341,-0.5646,-0.9567,-1.0853,-0.9116,-0.4954,0.0352,0.5400,0.9190,1.1368,1.2129,1.1894,1.0990,0.9531,0.7542,0.5195,0.2967,0.1539,0.1467,0.2775,0.4751,0.6115,0.5545,0.2353,-0.3046,-0.9147,-1.3885,-1.5504,-1.3339,-0.8159,-0.1874,0.3270,0.5627,0.4799,0.1695,-0.2008,-0.4704,-0.5593,-0.4945,-0.3816,-0.3374,-0.4227,-0.6100,-0.8017,-0.8866,-0.8038,-0.5773,-0.3034,-0.0978,-0.0308,-0.0880,-0.1771,-0.1806,-0.0254,0.2675,0.5819,0.7575,0.6705,0.3035,-0.2312,-0.7302,-0.9827,-0.8635,-0.3912,0.2764,0.9065,1.2881,1.3176,1.0364,0.6052,0.2299,0.0732,0.1896,0.5116,0.8876,1.1512,1.1893,0.9804,0.5913,0.1374,-0.2688,-0.5591,-0.7227,-0.7912,-0.8063,-0.7910,-0.7359,-0.6093,-0.3806,-0.0467,0.3547,0.7508,1.0551,1.1973,1.1462,0.9199,0.5791,0.2078,-0.1093,-0.3066,-0.3498,-0.2392,-0.0070,0.2898,0.5787,0.7852,0.8474,0.7326,0.4489,0.0475,-0.3879,-0.7636,-1.0031,-1.0700,-0.9762,-0.7711,-0.5175,-0.2639,-0.0270,0.2063,0.4592,0.7368,1.0058,1.1964,1.2283,1.0519,0.6840,0.2175,-0.2034,-0.4393,-0.4170,-0.1699,0.1669,0.4072,0.3940,0.0725,-0.4766,-1.0632,-1.4632,-1.5143,-1.1865,-0.5985,0.0315,0.4765,0.5947,0.3827,-0.0338,-0.4647,-0.7450,-0.8044,-0.6867,-0.5130,-0.4097,-0.4407,-0.5772,-0.7199,-0.7578,-0.6323,-0.3706,-0.0710,0.1508,0.2259,0.1695,0.0712,0.0427,0.1498,0.3677,0.5853,0.6590,0.4914,0.0925,-0.4081,-0.8093,-0.9258,-0.6727,-0.1082,0.5880,1.1891,1.5157,1.5052,1.2260,0.8356,0.5043,0.3432,0.3690,0.5150,0.6785,0.7723,0.7570,0.6401,0.4513,0.2138,-0.0672,-0.3918,-0.7399,-1.0522,-1.2371,-1.2043,-0.9124,-0.4025,0.2022,0.7365,1.0574,1.0999,0.8989,0.5651,0.2276,-0.0258,-0.1810,-0.2858,-0.4036,-0.5611,-0.7220,-0.8034,-0.7287,-0.4863,-0.1575,0.1056,0.1492,-0.1008,-0.5878,-1.1341,-1.5129,-1.5519,-1.2180,-0.6404,-0.0571,0.2928,0.2796,-0.0555,-0.5196,-0.8584,-0.8771,-0.5323,0.0466,0.6172,0.9353,0.8653,0.4387,-0.1640,-0.6963,-0.9537,-0.8554,-0.4672,0.0409,0.4765,0.7059,0.6996,0.5252,0.3005,0.1323,0.0703,0.0955,0.1405,0.1280,0.0060,-0.2333,-0.5557,-0.9000,-1.1971,-1.3854,-1.4199,-1.2799,-0.9754,-0.5532,-0.0947,0.2976,0.5266,0.5333,0.3216,-0.0362,-0.4193,-0.6975,-0.7749,-0.6209,-0.2756,0.1701,0.6095,0.9551,1.1590,1.2151,1.1466,0.9895,0.7797,0.5481,0.3201,0.1147,-0.0590,-0.2060,-0.3441,-0.4936,-0.6601,-0.8188,-0.9137,-0.8776,-0.6678,-0.3018,0.1289,0.4817,0.6175,0.4682,0.0815,-0.3823,-0.7088,-0.7222,-0.3713,0.2346,0.8614,1.2470,1.2183,0.7737,0.0904,-0.5492,-0.8805,-0.7722,-0.2811,0.3803,0.9454,1.2166,1.1486,0.8558,0.5414,0.3886,0.4694,0.7169,0.9722,1.0787};
	double excite;	// excitation command, rad
		
	if (i<1798){ excite = OMS4_ch3[i] * amp;}
	else {excite = 0.0;}
	return excite;
}


double playback_OMS4_4(int i, double amp) {
	// Recall the "canned" excitation
	static float OMS4_ch4[1799] = {1.0787,0.9712,0.7139,0.4656,0.3866,0.5425,0.8572,1.1435,1.1972,0.9080,0.3295,-0.3322,-0.8069,-0.8862,-0.5252,0.1307,0.8069,1.2207,1.2057,0.7811,0.1362,-0.4593,-0.7764,-0.7212,-0.3638,0.1062,0.4718,0.5818,0.4048,0.0250,-0.4091,-0.7550,-0.9295,-0.9266,-0.7983,-0.6160,-0.4345,-0.2748,-0.1279,0.0275,0.2077,0.4146,0.6355,0.8488,1.0273,1.1398,1.1521,1.0334,0.7698,0.3800,-0.0753,-0.5009,-0.7919,-0.8705,-0.7183,-0.3896,0.0027,0.3238,0.4634,0.3709,0.0679,-0.3650,-0.8199,-1.1946,-1.4182,-1.4599,-1.3271,-1.0564,-0.7049,-0.3409,-0.0327,0.1678,0.2421,0.2163,0.1551,0.1365,0.2142,0.3833,0.5720,0.6668,0.5660,0.2394,-0.2393,-0.7065,-0.9721,-0.9055,-0.5052,0.0854,0.6297,0.8973,0.7685,0.2925,-0.3305,-0.8378,-1.0248,-0.8392,-0.4054,0.0356,0.2409,0.0821,-0.3941,-0.9882,-1.4421,-1.5594,-1.2931,-0.7612,-0.1862,0.2110,0.3073,0.1212,-0.2123,-0.5188,-0.6686,-0.6279,-0.4534,-0.2425,-0.0690,0.0558,0.1782,0.3583,0.6156,0.8990,1.0986,1.0967,0.8309,0.3343,-0.2684,-0.8077,-1.1370,-1.1865,-0.9806,-0.6128,-0.1962,0.1832,0.4866,0.7137,0.8739,0.9642,0.9670,0.8709,0.6981,0.5160,0.4185,0.4810,0.7118,1.0284,1.2788,1.3039,1.0142,0.4438,-0.2497,-0.8427,-1.1385,-1.0519,-0.6453,-0.0994,0.3685,0.5984,0.5509,0.3096,0.0262,-0.1617,-0.1979,-0.1262,-0.0547,-0.0879,-0.2645,-0.5348,-0.7886,-0.9170,-0.8735,-0.6998,-0.5019,-0.3900,-0.4140,-0.5325,-0.6325,-0.5920,-0.3538,0.0312,0.4145,0.6148,0.5056,0.0843,-0.5132,-1.0632,-1.3466,-1.2436,-0.7855,-0.1414,0.4551,0.8046,0.8225,0.5668,0.2039,-0.0697,-0.1122,0.1079,0.5085,0.9372,1.2399,1.3209,1.1714,0.8574,0.4794,0.1253,-0.1598,-0.3771,-0.5534,-0.7103,-0.8423,-0.9128,-0.8725,-0.6858,-0.3554,0.0697,0.5051,0.8569,1.0509,1.0540,0.8813,0.5887,0.2550,-0.0386,-0.2253,-0.2647,-0.1485,0.0985,0.4217,0.7454,0.9869,1.0765,0.9769,0.6968,0.2921,-0.1500,-0.5365,-0.7983,-0.9094,-0.8883,-0.7811,-0.6338,-0.4685,-0.2755,-0.0267,0.2954,0.6702,1.0289,1.2722,1.3107,1.1122,0.7298,0.2943,-0.0322,-0.1247,0.0449,0.3861,0.7202,0.8546,0.6694,0.1772,-0.4725,-1.0510,-1.3452,-1.2490,-0.8092,-0.2053,0.3284,0.6024,0.5478,0.2346,-0.1721,-0.4971,-0.6356,-0.5931,-0.4675,-0.3854,-0.4301,-0.5962,-0.7972,-0.9162,-0.8734,-0.6715,-0.3941,-0.1594,-0.0537,-0.0829,-0.1696,-0.1982,-0.0856,0.1633,0.4457,0.6066,0.5188,0.1567,-0.3759,-0.8793,-1.1426,-1.0364,-0.5728,0.0990,0.7567,1.1995,1.3276,1.1726,0.8678,0.5784,0.4272,0.4509,0.6025,0.7909,0.9310,0.9778,0.9287,0.8019,0.6090,0.3450,0.0017,-0.4042,-0.8098,-1.1108,-1.1973,-1.0052,-0.5565,0.0359,0.6054,0.9972,1.1287,1.0172,0.7600,0.4787,0.2583,0.1132,-0.0024,-0.1488,-0.3467,-0.5515,-0.6702,-0.6178,-0.3789,-0.0382,0.2431,0.2990,0.0455,-0.4640,-1.0478,-1.4703,-1.5499,-1.2477,-0.6926,-0.1261,0.2084,0.1795,-0.1691,-0.6398,-0.9746,-0.9789,-0.6141,-0.0169,0.5642,0.8835,0.8091,0.3792,-0.2200,-0.7412,-0.9839,-0.8750,-0.4866,0.0104,0.4288,0.6450,0.6385,0.4819,0.2903,0.1620,0.1361,0.1851,0.2383,0.2201,0.0832,-0.1759,-0.5200,-0.8866,-1.2058,-1.4136,-1.4621,-1.3282,-1.0226,-0.5966,-0.1388,0.2417,0.4464,0.4211,0.1801,-0.1929,-0.5700,-0.8216,-0.8606,-0.6692,-0.2986,0.1552,0.5878,0.9194,1.1106,1.1606,1.0939,0.9442,0.7447,0.5245,0.3083,0.1140,-0.0526,-0.2010,-0.3519,-0.5230,-0.7098,-0.8736,-0.9479,-0.8658,-0.6000,-0.1951,0.2316,0.5262,0.5638,0.3140,-0.1287,-0.5702,-0.7946,-0.6624,-0.1843,0.4698,1.0360,1.2702,1.0609,0.4853,-0.2188,-0.7558,-0.9034,-0.6088,-0.0078,0.6449,1.0962,1.2097,1.0177,0.6900,0.4366,0.3978,0.5774,0.8526,1.0507,1.0507,0.8526,0.5774,0.3978,0.4366,0.6900,1.0177,1.2097,1.0962,0.6449,-0.0078,-0.6088,-0.9034,-0.7558,-0.2188,0.4853,1.0609,1.2702,1.0360,0.4698,-0.1843,-0.6624,-0.7946,-0.5702,-0.1287,0.3140,0.5638,0.5262,0.2316,-0.1951,-0.6000,-0.8658,-0.9479,-0.8736,-0.7098,-0.5230,-0.3519,-0.2010,-0.0526,0.1140,0.3083,0.5245,0.7447,0.9442,1.0939,1.1606,1.1106,0.9194,0.5878,0.1552,-0.2986,-0.6692,-0.8606,-0.8216,-0.5700,-0.1929,0.1801,0.4211,0.4464,0.2417,-0.1388,-0.5966,-1.0226,-1.3282,-1.4621,-1.4136,-1.2058,-0.8866,-0.5200,-0.1759,0.0832,0.2201,0.2383,0.1851,0.1361,0.1620,0.2903,0.4819,0.6385,0.6450,0.4288,0.0104,-0.4866,-0.8750,-0.9839,-0.7412,-0.2200,0.3792,0.8091,0.8835,0.5642,-0.0169,-0.6141,-0.9789,-0.9746,-0.6398,-0.1691,0.1795,0.2084,-0.1261,-0.6926,-1.2477,-1.5499,-1.4703,-1.0478,-0.4640,0.0455,0.2990,0.2431,-0.0382,-0.3789,-0.6178,-0.6702,-0.5515,-0.3467,-0.1488,-0.0024,0.1132,0.2583,0.4787,0.7600,1.0172,1.1287,0.9972,0.6054,0.0359,-0.5565,-1.0052,-1.1973,-1.1108,-0.8098,-0.4042,0.0017,0.3450,0.6090,0.8019,0.9287,0.9778,0.9310,0.7909,0.6025,0.4509,0.4272,0.5784,0.8678,1.1726,1.3276,1.1995,0.7567,0.0990,-0.5728,-1.0364,-1.1426,-0.8793,-0.3759,0.1567,0.5188,0.6066,0.4457,0.1633,-0.0856,-0.1982,-0.1696,-0.0829,-0.0537,-0.1594,-0.3941,-0.6715,-0.8734,-0.9162,-0.7972,-0.5962,-0.4301,-0.3854,-0.4675,-0.5931,-0.6356,-0.4971,-0.1721,0.2346,0.5478,0.6024,0.3284,-0.2053,-0.8092,-1.2490,-1.3452,-1.0510,-0.4725,0.1772,0.6694,0.8546,0.7202,0.3861,0.0449,-0.1247,-0.0322,0.2943,0.7298,1.1122,1.3107,1.2722,1.0289,0.6702,0.2954,-0.0267,-0.2755,-0.4685,-0.6338,-0.7811,-0.8883,-0.9094,-0.7983,-0.5365,-0.1500,0.2921,0.6968,0.9769,1.0765,0.9869,0.7454,0.4217,0.0985,-0.1485,-0.2647,-0.2253,-0.0386,0.2550,0.5887,0.8813,1.0540,1.0509,0.8569,0.5051,0.0697,-0.3554,-0.6858,-0.8725,-0.9128,-0.8423,-0.7103,-0.5534,-0.3771,-0.1598,0.1253,0.4794,0.8574,1.1714,1.3209,1.2399,0.9372,0.5085,0.1079,-0.1122,-0.0697,0.2039,0.5668,0.8225,0.8046,0.4551,-0.1414,-0.7855,-1.2436,-1.3466,-1.0632,-0.5132,0.0843,0.5056,0.6148,0.4145,0.0312,-0.3538,-0.5920,-0.6325,-0.5325,-0.4140,-0.3900,-0.5019,-0.6998,-0.8735,-0.9170,-0.7886,-0.5348,-0.2645,-0.0879,-0.0547,-0.1262,-0.1979,-0.1617,0.0262,0.3096,0.5509,0.5984,0.3685,-0.0994,-0.6453,-1.0519,-1.1385,-0.8427,-0.2497,0.4438,1.0142,1.3039,1.2788,1.0284,0.7118,0.4810,0.4185,0.5160,0.6981,0.8709,0.9670,0.9642,0.8739,0.7137,0.4866,0.1832,-0.1962,-0.6128,-0.9806,-1.1865,-1.1370,-0.8077,-0.2684,0.3343,0.8309,1.0967,1.0986,0.8990,0.6156,0.3583,0.1782,0.0558,-0.0690,-0.2425,-0.4534,-0.6279,-0.6686,-0.5188,-0.2123,0.1212,0.3073,0.2110,-0.1862,-0.7612,-1.2931,-1.5594,-1.4421,-0.9882,-0.3941,0.0821,0.2409,0.0356,-0.4054,-0.8392,-1.0248,-0.8378,-0.3305,0.2925,0.7685,0.8973,0.6297,0.0854,-0.5052,-0.9055,-0.9721,-0.7065,-0.2393,0.2394,0.5660,0.6668,0.5720,0.3833,0.2142,0.1365,0.1551,0.2163,0.2421,0.1678,-0.0327,-0.3409,-0.7049,-1.0564,-1.3271,-1.4599,-1.4182,-1.1946,-0.8199,-0.3650,0.0679,0.3709,0.4634,0.3238,0.0027,-0.3896,-0.7183,-0.8705,-0.7919,-0.5009,-0.0753,0.3800,0.7698,1.0334,1.1521,1.1398,1.0273,0.8488,0.6355,0.4146,0.2077,0.0275,-0.1279,-0.2748,-0.4345,-0.6160,-0.7983,-0.9266,-0.9295,-0.7550,-0.4091,0.0250,0.4048,0.5818,0.4718,0.1062,-0.3638,-0.7212,-0.7764,-0.4593,0.1362,0.7811,1.2057,1.2207,0.8069,0.1307,-0.5252,-0.8862,-0.8069,-0.3322,0.3295,0.9080,1.1972,1.1435,0.8572,0.5425,0.3866,0.4656,0.7139,0.9712,1.0787,0.9712,0.7139,0.4656,0.3866,0.5425,0.8572,1.1435,1.1972,0.9080,0.3295,-0.3322,-0.8069,-0.8862,-0.5252,0.1307,0.8069,1.2207,1.2057,0.7811,0.1362,-0.4593,-0.7764,-0.7212,-0.3638,0.1062,0.4718,0.5818,0.4048,0.0250,-0.4091,-0.7550,-0.9295,-0.9266,-0.7983,-0.6160,-0.4345,-0.2748,-0.1279,0.0275,0.2077,0.4146,0.6355,0.8488,1.0273,1.1398,1.1521,1.0334,0.7698,0.3800,-0.0753,-0.5009,-0.7919,-0.8705,-0.7183,-0.3896,0.0027,0.3238,0.4634,0.3709,0.0679,-0.3650,-0.8199,-1.1946,-1.4182,-1.4599,-1.3271,-1.0564,-0.7049,-0.3409,-0.0327,0.1678,0.2421,0.2163,0.1551,0.1365,0.2142,0.3833,0.5720,0.6668,0.5660,0.2394,-0.2393,-0.7065,-0.9721,-0.9055,-0.5052,0.0854,0.6297,0.8973,0.7685,0.2925,-0.3305,-0.8378,-1.0248,-0.8392,-0.4054,0.0356,0.2409,0.0821,-0.3941,-0.9882,-1.4421,-1.5594,-1.2931,-0.7612,-0.1862,0.2110,0.3073,0.1212,-0.2123,-0.5188,-0.6686,-0.6279,-0.4534,-0.2425,-0.0690,0.0558,0.1782,0.3583,0.6156,0.8990,1.0986,1.0967,0.8309,0.3343,-0.2684,-0.8077,-1.1370,-1.1865,-0.9806,-0.6128,-0.1962,0.1832,0.4866,0.7137,0.8739,0.9642,0.9670,0.8709,0.6981,0.5160,0.4185,0.4810,0.7118,1.0284,1.2788,1.3039,1.0142,0.4438,-0.2497,-0.8427,-1.1385,-1.0519,-0.6453,-0.0994,0.3685,0.5984,0.5509,0.3096,0.0262,-0.1617,-0.1979,-0.1262,-0.0547,-0.0879,-0.2645,-0.5348,-0.7886,-0.9170,-0.8735,-0.6998,-0.5019,-0.3900,-0.4140,-0.5325,-0.6325,-0.5920,-0.3538,0.0312,0.4145,0.6148,0.5056,0.0843,-0.5132,-1.0632,-1.3466,-1.2436,-0.7855,-0.1414,0.4551,0.8046,0.8225,0.5668,0.2039,-0.0697,-0.1122,0.1079,0.5085,0.9372,1.2399,1.3209,1.1714,0.8574,0.4794,0.1253,-0.1598,-0.3771,-0.5534,-0.7103,-0.8423,-0.9128,-0.8725,-0.6858,-0.3554,0.0697,0.5051,0.8569,1.0509,1.0540,0.8813,0.5887,0.2550,-0.0386,-0.2253,-0.2647,-0.1485,0.0985,0.4217,0.7454,0.9869,1.0765,0.9769,0.6968,0.2921,-0.1500,-0.5365,-0.7983,-0.9094,-0.8883,-0.7811,-0.6338,-0.4685,-0.2755,-0.0267,0.2954,0.6702,1.0289,1.2722,1.3107,1.1122,0.7298,0.2943,-0.0322,-0.1247,0.0449,0.3861,0.7202,0.8546,0.6694,0.1772,-0.4725,-1.0510,-1.3452,-1.2490,-0.8092,-0.2053,0.3284,0.6024,0.5478,0.2346,-0.1721,-0.4971,-0.6356,-0.5931,-0.4675,-0.3854,-0.4301,-0.5962,-0.7972,-0.9162,-0.8734,-0.6715,-0.3941,-0.1594,-0.0537,-0.0829,-0.1696,-0.1982,-0.0856,0.1633,0.4457,0.6066,0.5188,0.1567,-0.3759,-0.8793,-1.1426,-1.0364,-0.5728,0.0990,0.7567,1.1995,1.3276,1.1726,0.8678,0.5784,0.4272,0.4509,0.6025,0.7909,0.9310,0.9778,0.9287,0.8019,0.6090,0.3450,0.0017,-0.4042,-0.8098,-1.1108,-1.1973,-1.0052,-0.5565,0.0359,0.6054,0.9972,1.1287,1.0172,0.7600,0.4787,0.2583,0.1132,-0.0024,-0.1488,-0.3467,-0.5515,-0.6702,-0.6178,-0.3789,-0.0382,0.2431,0.2990,0.0455,-0.4640,-1.0478,-1.4703,-1.5499,-1.2477,-0.6926,-0.1261,0.2084,0.1795,-0.1691,-0.6398,-0.9746,-0.9789,-0.6141,-0.0169,0.5642,0.8835,0.8091,0.3792,-0.2200,-0.7412,-0.9839,-0.8750,-0.4866,0.0104,0.4288,0.6450,0.6385,0.4819,0.2903,0.1620,0.1361,0.1851,0.2383,0.2201,0.0832,-0.1759,-0.5200,-0.8866,-1.2058,-1.4136,-1.4621,-1.3282,-1.0226,-0.5966,-0.1388,0.2417,0.4464,0.4211,0.1801,-0.1929,-0.5700,-0.8216,-0.8606,-0.6692,-0.2986,0.1552,0.5878,0.9194,1.1106,1.1606,1.0939,0.9442,0.7447,0.5245,0.3083,0.1140,-0.0526,-0.2010,-0.3519,-0.5230,-0.7098,-0.8736,-0.9479,-0.8658,-0.6000,-0.1951,0.2316,0.5262,0.5638,0.3140,-0.1287,-0.5702,-0.7946,-0.6624,-0.1843,0.4698,1.0360,1.2702,1.0609,0.4853,-0.2188,-0.7558,-0.9034,-0.6088,-0.0078,0.6449,1.0962,1.2097,1.0177,0.6900,0.4366,0.3978,0.5774,0.8526,1.0507,1.0507,0.8526,0.5774,0.3978,0.4366,0.6900,1.0177,1.2097,1.0962,0.6449,-0.0078,-0.6088,-0.9034,-0.7558,-0.2188,0.4853,1.0609,1.2702,1.0360,0.4698,-0.1843,-0.6624,-0.7946,-0.5702,-0.1287,0.3140,0.5638,0.5262,0.2316,-0.1951,-0.6000,-0.8658,-0.9479,-0.8736,-0.7098,-0.5230,-0.3519,-0.2010,-0.0526,0.1140,0.3083,0.5245,0.7447,0.9442,1.0939,1.1606,1.1106,0.9194,0.5878,0.1552,-0.2986,-0.6692,-0.8606,-0.8216,-0.5700,-0.1929,0.1801,0.4211,0.4464,0.2417,-0.1388,-0.5966,-1.0226,-1.3282,-1.4621,-1.4136,-1.2058,-0.8866,-0.5200,-0.1759,0.0832,0.2201,0.2383,0.1851,0.1361,0.1620,0.2903,0.4819,0.6385,0.6450,0.4288,0.0104,-0.4866,-0.8750,-0.9839,-0.7412,-0.2200,0.3792,0.8091,0.8835,0.5642,-0.0169,-0.6141,-0.9789,-0.9746,-0.6398,-0.1691,0.1795,0.2084,-0.1261,-0.6926,-1.2477,-1.5499,-1.4703,-1.0478,-0.4640,0.0455,0.2990,0.2431,-0.0382,-0.3789,-0.6178,-0.6702,-0.5515,-0.3467,-0.1488,-0.0024,0.1132,0.2583,0.4787,0.7600,1.0172,1.1287,0.9972,0.6054,0.0359,-0.5565,-1.0052,-1.1973,-1.1108,-0.8098,-0.4042,0.0017,0.3450,0.6090,0.8019,0.9287,0.9778,0.9310,0.7909,0.6025,0.4509,0.4272,0.5784,0.8678,1.1726,1.3276,1.1995,0.7567,0.0990,-0.5728,-1.0364,-1.1426,-0.8793,-0.3759,0.1567,0.5188,0.6066,0.4457,0.1633,-0.0856,-0.1982,-0.1696,-0.0829,-0.0537,-0.1594,-0.3941,-0.6715,-0.8734,-0.9162,-0.7972,-0.5962,-0.4301,-0.3854,-0.4675,-0.5931,-0.6356,-0.4971,-0.1721,0.2346,0.5478,0.6024,0.3284,-0.2053,-0.8092,-1.2490,-1.3452,-1.0510,-0.4725,0.1772,0.6694,0.8546,0.7202,0.3861,0.0449,-0.1247,-0.0322,0.2943,0.7298,1.1122,1.3107,1.2722,1.0289,0.6702,0.2954,-0.0267,-0.2755,-0.4685,-0.6338,-0.7811,-0.8883,-0.9094,-0.7983,-0.5365,-0.1500,0.2921,0.6968,0.9769,1.0765,0.9869,0.7454,0.4217,0.0985,-0.1485,-0.2647,-0.2253,-0.0386,0.2550,0.5887,0.8813,1.0540,1.0509,0.8569,0.5051,0.0697,-0.3554,-0.6858,-0.8725,-0.9128,-0.8423,-0.7103,-0.5534,-0.3771,-0.1598,0.1253,0.4794,0.8574,1.1714,1.3209,1.2399,0.9372,0.5085,0.1079,-0.1122,-0.0697,0.2039,0.5668,0.8225,0.8046,0.4551,-0.1414,-0.7855,-1.2436,-1.3466,-1.0632,-0.5132,0.0843,0.5056,0.6148,0.4145,0.0312,-0.3538,-0.5920,-0.6325,-0.5325,-0.4140,-0.3900,-0.5019,-0.6998,-0.8735,-0.9170,-0.7886,-0.5348,-0.2645,-0.0879,-0.0547,-0.1262,-0.1979,-0.1617,0.0262,0.3096,0.5509,0.5984,0.3685,-0.0994,-0.6453,-1.0519,-1.1385,-0.8427,-0.2497,0.4438,1.0142,1.3039,1.2788,1.0284,0.7118,0.4810,0.4185,0.5160,0.6981,0.8709,0.9670,0.9642,0.8739,0.7137,0.4866,0.1832,-0.1962,-0.6128,-0.9806,-1.1865,-1.1370,-0.8077,-0.2684,0.3343,0.8309,1.0967,1.0986,0.8990,0.6156,0.3583,0.1782,0.0558,-0.0690,-0.2425,-0.4534,-0.6279,-0.6686,-0.5188,-0.2123,0.1212,0.3073,0.2110,-0.1862,-0.7612,-1.2931,-1.5594,-1.4421,-0.9882,-0.3941,0.0821,0.2409,0.0356,-0.4054,-0.8392,-1.0248,-0.8378,-0.3305,0.2925,0.7685,0.8973,0.6297,0.0854,-0.5052,-0.9055,-0.9721,-0.7065,-0.2393,0.2394,0.5660,0.6668,0.5720,0.3833,0.2142,0.1365,0.1551,0.2163,0.2421,0.1678,-0.0327,-0.3409,-0.7049,-1.0564,-1.3271,-1.4599,-1.4182,-1.1946,-0.8199,-0.3650,0.0679,0.3709,0.4634,0.3238,0.0027,-0.3896,-0.7183,-0.8705,-0.7919,-0.5009,-0.0753,0.3800,0.7698,1.0334,1.1521,1.1398,1.0273,0.8488,0.6355,0.4146,0.2077,0.0275,-0.1279,-0.2748,-0.4345,-0.6160,-0.7983,-0.9266,-0.9295,-0.7550,-0.4091,0.0250,0.4048,0.5818,0.4718,0.1062,-0.3638,-0.7212,-0.7764,-0.4593,0.1362,0.7811,1.2057,1.2207,0.8069,0.1307,-0.5252,-0.8862,-0.8069,-0.3322,0.3295,0.9080,1.1972,1.1435,0.8572,0.5425,0.3866,0.4656,0.7139,0.9712,1.0787};
	double excite;	// excitation command, rad
		
	if (i<1798){ excite = OMS4_ch4[i] * amp;}
	else {excite = 0.0;}
	return excite;
}



